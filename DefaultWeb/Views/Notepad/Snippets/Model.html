<head>
    <style type="text/css">

 p.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	}
    </style>
</head>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black">define(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;archive/model&#39;</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black">, </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> () {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> viewModel = {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// control thumbnail rendering</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:
Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>thumbnails: ko.observableArray(),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>thumb: ko.observable(),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>thumbRendered: </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> (elements, item) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> count = elements.length;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;thumbRendered: &#39;</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black"> + elements + item);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>},<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>thumbAdded: </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> (parent, index, element) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> $image = $(parent).find(</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;img&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> rendered = $image[0].complete;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">if</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> (!rendered) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;thumbAdded-!rendered: &#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black"> + $image.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;class&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$image.on(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;load&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">, </span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> () {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>finishLoadingThumb($(parent));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">else</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>console.log(</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;thumbAdded-rendered: &#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:
Consolas;color:black"> + $image.attr(</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;class&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>finishLoadingThumb($(parent));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<span style="mso-spacerun:yes"> </span><o:p></o:p></span>
</p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>},<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>docCacheQueue: ko.observableArray(),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>name: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>friendlyname: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>description: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>filepubliclink: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mainfileurl: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mainviewurl: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span>videosource: ko.observable(),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mainviewtarget: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>imageviewurl: </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> () { </span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">return</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:blue">this</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black">.mainviewurl; },<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>videoviewurl: </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> () { </span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">return</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:blue">this</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black">.mainviewurl; },<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>docviewurl: </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> () { </span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">return</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:blue">this</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black">.mainviewurl; },<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtualpath: ko.observable(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>exif: ko.observableArray(),<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>};<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>viewModel.docCacheQueue.subscribe(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> (changes) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> change = changes[0];<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">if</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> (change.status === </span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;added&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> obj = viewModel.docCacheQueue.pop();</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:green">/// queue pop</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;docCacheQueue(pop):&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>startCachingDoc(obj.$link);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>}, </span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">null</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">, </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:#A31515">&#39;arrayChange&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> startCachingDoc($link) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> deferred = </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:blue">new</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"> </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#2B91AF">$</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">.Deferred();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// deferred callback</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:
Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>deferred.done(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> (result) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;deferred success:&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black"> + $link.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>})<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.fail(</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> (error) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;deferred fail:&#39;</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black"> + error + $link.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}).always(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> () {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cacheDoc($link, deferred);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> cacheDoc($link, deferred) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;cacheDoc:&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> + $link.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> docUrl = </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:#A31515">&quot;/fileview?virtualpath=&quot;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> + encodeURIComponent($link.attr(</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="SV" style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue;mso-ansi-language:
SV">var</span><span lang="SV" style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black;mso-ansi-language:SV"> mimetype = $link.attr(</span><span lang="SV" style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:#A31515;mso-ansi-language:SV">&#39;data-mime-type&#39;</span><span lang="SV" style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black;mso-ansi-language:SV">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span lang="SV" style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black;mso-ansi-language:SV"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="SV" style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:blue;mso-ansi-language:SV">var</span><span lang="SV" style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black;mso-ansi-language:SV"> $tempDoc;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span lang="SV" style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black;mso-ansi-language:SV"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:
Consolas;color:blue">switch</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black"> (mimetype) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">case</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> </span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:#A31515">&quot;image/jpeg&quot;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">:<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$tempDoc = $(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;&lt;img /&gt;&#39;</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">break</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">default</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">:<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;cacheDoc:&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> + $link.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">) + </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;-Skipped-Uncachable file type:&#39;</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"> + mimetype);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:green">//finishCachingDoc($link);</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>deferred.resolve(finishCachingDoc($link));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">return</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$tempDoc.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;src&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">, docUrl);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">var</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> completed = $tempDoc[0].complete;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">if</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> (!completed) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$tempDoc.on(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&quot;appear&quot;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">, </span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"> () {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>deferred.resolve(finishCachingDoc($link));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">else</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>deferred.resolve(finishCachingDoc($link));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <o:p></o:p>
</p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// remove loading from &lt;li&gt;, $thumbnail is &lt;li&gt;</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> finishLoadingThumb($thumbnail) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// switch up animation here</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// start pre-loading this thumb&#39;s target doc</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$link = $thumbnail.children(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;a&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;docCacheQueue(push):&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black"> + $link.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">));</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:green">/// queue push</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>viewModel.docCacheQueue.push({ $link });<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$thumbnail.removeClass(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&quot;loading&quot;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$thumbnail.addClass(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&quot;docloading&quot;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// remove loading from &lt;li&gt; parent, $link is &lt;a&gt;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">function</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> finishCachingDoc($link) {<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;finishCachingDoc:&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black"> + $link.attr(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;data-virtual-path&#39;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$link.parent(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;li&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">).addClass(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&quot;loaded&quot;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$link.parent(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;li&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">).removeClass(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&quot;docloading&quot;</span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span>
</p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">// counter, callback when queue is emptied</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">if</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> (viewModel.thumb++ &gt;= viewModel.thumbnails().length)<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$(</span><span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;div#thumbnailContainer&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">).removeClass(</span><span style="font-size:9.5pt;font-family:
Consolas;mso-bidi-font-family:Consolas;color:#A31515">&#39;loading&#39;</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>console.log(</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:#A31515">&#39;DONE!!!&#39;</span><span style="font-size:9.5pt;font-family:Consolas;
mso-bidi-font-family:Consolas;color:black">);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:green">//we should be done</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:
Consolas;color:black"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none">
    <span style="font-size:
9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:black"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;
font-family:Consolas;mso-bidi-font-family:Consolas;color:blue">return</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;
color:black"> viewModel;<o:p></o:p></span></p>
<p class="MsoNormal">
    <span style="font-size:9.5pt;line-height:107%;font-family:
Consolas;mso-bidi-font-family:Consolas;color:black">});</span><o:p></o:p></p>
