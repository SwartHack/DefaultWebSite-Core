//>>built
define(["dws/controller","dws/model"],function(m,d){function k(){d.waitingTarget("#navbar-main");d.waiting(!0);$.ajax({url:"/api/dws/files/list",cache:!1}).done(function(a,b,c){d.serverFiles([]);d.serverFiles(a)}).fail(function(a,b,c){d.abort(a,b,c)}).always(function(a,b,c){d.waiting(!1)})}function g(a){var b=a.attr("id");l(a);a=d.serverFiles().findIndex(function(a){return a.id==b});d.serverFile(d.serverFiles()[a])}function e(){var a=$("ul#thumbnails li.selected").next("li");$(a).trigger("click")}
function f(){var a=$("ul#thumbnails li.selected").closest("li");$(a).trigger("click")}function l(a){$("ul#thumbnails li").removeClass("selected");a.addClass("selected")}function h(){$(".content-area").hide()}d.serverFile.subscribe(function(a){if(a.mimeType.match("application/pdf")){for(var b=document.querySelector(".main-content .main-document");b.firstChild;)b.removeChild(b.firstChild);var c=document.createElement("embed");c.setAttribute("id","doc-embedded");c.setAttribute("src",a.fileApi);c.setAttribute("type",
a.mimeType);b.appendChild(c)}else!a.mimeType.match("image/*")&&a.mimeType().match("video/*")&&(b=document.querySelector(".main-content .main-video video"),c=document.createElement("source"),c.setAttribute("src",a.fileApi),c.setAttribute("type",a.mimeType),$(b).empty(),b.appendChild(c),b.load());a=$(a.fileTarget);a.is(":visible")||($(".content-area").hide(),a.css("display","inline-flex"),a.show())});return{init:function(){$(document).on("click","ul#thumbnails li",function(a){a.preventDefault();a=$(this);
a.hasClass("selected")||g(a)});$(".main-document.content-area").on("hide",function(){});$(document).on("keydown","#main-content-area",function(a){if(37===a.keyCode)return f(),!1;if(39===a.keyCode)return e(),!1});$("#content-prev").on("click",function(a){f()});$("#content-next").on("click",function(a){e()});$(".main-content-area").on("swipeleft",function(a){f()});$(".main-image").on("swiperight",function(a){e()});h();k()},contentNext:e,contentPrev:f,clickThumbnail:function(a){g(a)},hideAllContent:h,
showContent:function(a){}}});