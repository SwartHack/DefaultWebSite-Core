//>>built
require({cache:{"esri/Map":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/Accessor ./core/CollectionFlattener ./core/Evented ./core/Logger ./support/LayersMixin ./Basemap ./Ground ./support/basemapUtils ./support/groundUtils ./core/accessorSupport/decorators".split(" "),function(u,p,m,b,c,h,e,g,n,k,l,w,r,a){var f=g.getLogger("esri.Map");return function(t){function e(a){a=t.call(this)||this;return a.basemap=null,a.ground=new l,a._basemapCache=
w.createCache(),a}return m(e,t),Object.defineProperty(e.prototype,"allLayers",{get:function(){return new h({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:function(a){return a.layers}})},enumerable:!0,configurable:!0}),e.prototype.castBasemap=function(a){return w.ensureType(a,this._basemapCache)},e.prototype.castGround=function(a){return(a=r.ensureType(a))?a:(f.error("Map.ground may not be set to null or undefined"),this._get("ground"))},
b([a.property({readOnly:!0})],e.prototype,"allLayers",null),b([a.property({type:k})],e.prototype,"basemap",void 0),b([a.cast("basemap")],e.prototype,"castBasemap",null),b([a.property({type:l})],e.prototype,"ground",void 0),b([a.cast("ground")],e.prototype,"castGround",null),e=b([a.subclass("esri.Map")],e)}(a.declared(c,e,n))})},"esri/core/CollectionFlattener":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Collection ./HandleRegistry".split(" "),
function(u,p,m,b,c,h,e){return function(g){function n(b){b=g.call(this)||this;return b._handles=new e,b.root=null,b.refresh=b.refresh.bind(b),b.updateCollections=b.updateCollections.bind(b),b}return m(n,g),n.prototype.initialize=function(){var b=this;this._handles.add(this.rootCollectionNames.map(function(e){return b.watch("root."+e,b.updateCollections,!0)}));this.updateCollections()},n.prototype.destroy=function(){this.root=null;this.refresh();this._handles.destroy();this._handles=null},n.prototype.updateCollections=
function(){var b=this;this._collections=this.rootCollectionNames.map(function(e){return b.get("root."+e)}).filter(function(b){return null!=b});this.refresh()},n.prototype.refresh=function(){var b=this._handles;b.remove("collections");this.removeAll();for(var e=this._collections.slice(),h=0,c=this._collections;h<c.length;h++)this._processCollection(e,this,c[h]);for(h=0;h<e.length;h++)b.add(e[h].on("after-changes",this.refresh),"collections")},n.prototype._createNewInstance=function(b){return new h(b)},
n.prototype._processCollection=function(b,e,h){var c=this;h&&(b.push(h),h.forEach(function(a){a&&(e.push(a),c._processCollection(b,e,c.getChildrenFunction(a)))}))},b([c.property()],n.prototype,"rootCollectionNames",void 0),b([c.property()],n.prototype,"root",void 0),b([c.property()],n.prototype,"getChildrenFunction",void 0),n=b([c.subclass("esri.core.CollectionFlattener")],n)}(c.declared(h))})},"esri/support/LayersMixin":function(){define(["../core/Accessor","../core/Collection","../core/Logger"],
function(u,p,m){var b=function(h,e,c){for(var g,k,l=0,w=h.length;w>l;l++){if(g=h.getItemAt(l),g[e]===c)return g;if(g.layers&&(k=b(g.layers,e,c)))return k}},c=m.getLogger("esri.support.LayersMixin");return u.createSubclass({declaredClass:"esri.support.LayersMixin",destroy:function(){this._layersHandle.remove();this._layersHandle=null;this.layers.drain(this._lyrRemove,this)},properties:{layers:{type:p,get:function(){var b=this._get("layers");return b?b:(b=new p,b.on("after-add",function(b){b=b.item;
b.parent&&b.parent!==this&&b.parent.remove(b);b.parent=this;this.layerAdded(b);"elevation"===b.type&&c.error("Layer '"+b.title+", id:"+b.id+"' of type '"+b.type+"' is not supported as an operational layer and will therefore be ignored.")}.bind(this)),b.on("after-remove",function(b){b=b.item;b.parent=null;this.layerRemoved(b)}.bind(this)),b)},set:function(b){var e=this._get("layers");e&&this.remove(e.toArray());this.addMany(b.toArray())}}},findLayerById:function(h){return b(this.layers,"id",h)},add:function(b,
e){var c=this.layers;return e=c.getNextIndex(e),b.parent===this?void this.reorder(b,e):void c.add(b,e)},addMany:function(b,e){var c=this.layers;e=c.getNextIndex(e);b.slice().forEach(function(b){return b.parent===this?void this.reorder(b,e):(c.add(b,e),void(e+=1))},this)},remove:function(b){return this.layers.remove(b)},removeMany:function(b){return this.layers.removeMany(b)},removeAll:function(){return this.layers.removeAll()},reorder:function(b,c){return this.layers.reorder(b,c)},findLayerByUid:function(c){return b(this.layers,
"uid",c)},layerAdded:function(b){},layerRemoved:function(b){}})})},"esri/Basemap":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./support/basemapDefinitions ./core/Collection ./core/collectionUtils ./core/Evented ./core/JSONSupport ./core/Loadable ./core/promiseUtils ./core/requireUtils ./core/urlUtils ./core/Logger ./portal/Portal ./portal/PortalItem ./layers/Layer".split(" "),function(u,
p,m,b,c,h,e,g,n,k,l,w,r,a,f,t,y,q,C){var d=0,x=g.ofType(C),M=t.getLogger("esri.Basemap");return function(t){function v(a){a=t.call(this)||this;a.id=null;a.portalItem=null;a.thumbnailUrl=null;a.title="Basemap";a.id=Date.now().toString(16)+"-basemap-"+d++;a.baseLayers=new g;a.referenceLayers=new g;var b=function(a){"elevation"===a.type&&M.error("Layer '"+a.title+", id:"+a.id+"' of type '"+a.type+"' is not supported as a basemap layer and will therefore be ignored.")};return a.baseLayers.on("after-add",
function(a){return b(a.item)}),a.referenceLayers.on("after-add",function(a){return b(a.item)}),a}return m(v,t),P=v,v.prototype.initialize=function(){var a=this;this.when()["catch"](function(d){M.error("#load()","Failed to load basemap (title: '"+a.title+"', id: '"+a.id+"')",d)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},v.prototype.normalizeCtorArgs=function(a){return a&&"resourceInfo"in a&&(this._set("resourceInfo",a.resourceInfo),a=h.mixin({},a),delete a.resourceInfo),
a},Object.defineProperty(v.prototype,"baseLayers",{set:function(a){this._set("baseLayers",n.referenceSetter(a,this._get("baseLayers"),x))},enumerable:!0,configurable:!0}),v.prototype.writeBaseLayers=function(a,d,b,f){var q=[];return a?(f=h.mixin({},f,{layerContainerType:"basemap"}),this.baseLayers.forEach(function(a){if(a.write){var d={};a.write(d,f)&&q.push(d)}}),this.referenceLayers.forEach(function(a){if(a.write){var d={isReference:!0};a.write(d,f)&&q.push(d)}}),void(d[b]=q)):void(d[b]=q)},Object.defineProperty(v.prototype,
"referenceLayers",{set:function(a){this._set("referenceLayers",n.referenceSetter(a,this._get("referenceLayers"),x))},enumerable:!0,configurable:!0}),v.prototype.writeTitle=function(a,d){d.title=a||"Basemap"},v.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},v.prototype.clone=function(){var a={id:this.id,title:this.title,portalItem:this.portalItem,resourceInfo:this.resourceInfo,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};
return this.loaded&&(a.loadStatus="loaded"),new P(a)},v.prototype.read=function(a,d){return this.resourceInfo||this._set("resourceInfo",{data:a,context:d}),this.inherited(arguments)},v.prototype.write=function(a,d){return a=a||{},d&&d.origin||(d=h.mixin({origin:"web-map"},d)),this.inherited(arguments,[a,d]),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(a.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(function(a){a=h.clone(a);return a.url&&f.isProtocolRelative(a.url)&&
(a.url="https:"+a.url),a.templateUrl&&f.isProtocolRelative(a.templateUrl)&&(a.templateUrl="https:"+a.templateUrl),a})),a},v.prototype._loadFromSource=function(){var a=this.resourceInfo,d=this.portalItem;return a?this._loadLayersFromJSON(a.data,a.context?a.context.url:null):d?this._loadFromItem(d):r.resolve(null)},v.prototype._loadLayersFromJSON=function(d,b){var f=this,q=this.resourceInfo&&this.resourceInfo.context,x=this.portalItem&&this.portalItem.portal||q&&q.portal||null,M=q&&"web-scene"===q.origin?
"web-scene":"web-map";return a.when(u,"./portal/support/layersCreator").then(function(a){var q=[];if(d.baseMapLayers&&Array.isArray(d.baseMapLayers)){var t={context:{origin:M,url:b,portal:x,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},c=a.populateOperationalLayers(f.baseLayers,d.baseMapLayers.filter(function(a){return!a.isReference}),t);q.push.apply(q,c);a=a.populateOperationalLayers(f.referenceLayers,d.baseMapLayers.filter(function(a){return a.isReference}),t);q.push.apply(q,
a)}return r.eachAlways(q)}).then(function(){})},v.prototype._loadFromItem=function(a){var d=this;return a.load().then(function(a){return a.fetchData()}).then(function(b){var q=f.urlToObject(a.itemUrl);return d._set("resourceInfo",{data:b.baseMap,context:{origin:"web-map",portal:a.portal||y.getDefault(),url:q}}),d.read(d.resourceInfo.data,d.resourceInfo.context),d.read({title:a.title,thumbnailUrl:a.thumbnailUrl},{origin:"portal-item",portal:a.portal||y.getDefault(),url:q}),d._loadLayersFromJSON(d.resourceInfo.data,
q)})},v.fromId=function(a){return(a=e[a])?P.fromJSON(a):null},b([c.property({type:x,json:{write:{ignoreOrigin:!0,target:"baseMapLayers"}}}),c.cast(n.castForReferenceSetter)],v.prototype,"baseLayers",null),b([c.writer("baseLayers")],v.prototype,"writeBaseLayers",null),b([c.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],v.prototype,"id",void 0),b([c.property({type:q})],v.prototype,"portalItem",void 0),b([c.property({type:x}),c.cast(n.castForReferenceSetter)],v.prototype,"referenceLayers",
null),b([c.property({readOnly:!0})],v.prototype,"resourceInfo",void 0),b([c.property()],v.prototype,"thumbnailUrl",void 0),b([c.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],v.prototype,"title",void 0),b([c.writer("title")],v.prototype,"writeTitle",null),v=P=b([c.subclass("esri.Basemap")],v);var P}(c.declared(l,k,w))})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(u,p,m){Object.defineProperty(p,"__esModule",{value:!0});
p.referenceSetter=function(b,c,h){void 0===h&&(h=m);c||(c=new h);c.removeAll();return b&&(Array.isArray(b)||b.isInstanceOf&&b.isInstanceOf(m))?c.addMany(b):c.add(b),c};p.castForReferenceSetter=function(b){return b}})},"esri/Ground":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./core/JSONSupport ./core/Loadable ./core/Collection ./core/collectionUtils ./core/Logger ./core/requireUtils ./core/promiseUtils ./core/Error ./layers/Layer ./layers/support/types".split(" "),
function(u,p,m,b,c,h,e,g,n,k,l,w,r,a,f,t){var y=n.ofType(f),q=l.getLogger("esri.Ground");return function(f){function d(a){a=f.call(this)||this;return a.layers=new y,a.layers.on("after-add",function(a){a=a.item;t.isOfType(a,["elevation","base-elevation"])||q.error("Layer '"+a.title+", id:"+a.id+"' of type '"+a.type+"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.")}),a}return m(d,f),x=d,d.prototype.initialize=function(){this.when()["catch"](function(a){q.error("#load()",
"Failed to load ground",a)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},d.prototype.normalizeCtorArgs=function(a){return a&&"resourceInfo"in a&&(this._set("resourceInfo",a.resourceInfo),a=h.mixin({},a),delete a.resourceInfo),a},Object.defineProperty(d.prototype,"layers",{set:function(a){this._set("layers",k.referenceSetter(a,this._get("layers"),y))},enumerable:!0,configurable:!0}),d.prototype.writeLayers=function(d,b,f,q){var x=[];return d?(q=h.mixin({},q,{layerContainerType:"ground"}),
d.forEach(function(d){if(d.write){var b={};d.write(b,q)&&x.push(b)}else q&&q.messages&&q.messages.push(new a("layer:unsupported","Layers ("+d.title+", "+d.id+") of type '"+d.declaredClass+"' cannot be persisted in the ground",{layer:d}))}),void(b.layers=x)):void(b.layers=x)},d.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},d.prototype.queryElevation=function(a,d){var b=this;return w.when(u,"./layers/support/ElevationQuery").then(function(f){f=new f.ElevationQuery;
var q=b.layers.filter(function(a){return"elevation"===a.type}).toArray();return f.queryAll(q,a,d)})},d.prototype.clone=function(){var a={resourceInfo:this.resourceInfo,layers:this.layers.slice()};return this.loaded&&(a.loadStatus="loaded"),new x(a)},d.prototype.read=function(a,d){return this.resourceInfo||this._set("resourceInfo",{data:a,context:d}),this.inherited(arguments)},d.prototype._loadFromSource=function(){var a=this.resourceInfo;return a?this._loadLayersFromJSON(a.data,a.context):r.resolve(null)},
d.prototype._loadLayersFromJSON=function(a,d){var b=this,f=d&&d.origin||"web-scene",q=d&&d.portal||null,x=d&&d.url||null;return w.when(u,"./portal/support/layersCreator").then(function(d){var t=[];a.layers&&Array.isArray(a.layers)&&t.push.apply(t,d.populateOperationalLayers(b.layers,a.layers,{context:{origin:f,url:x,portal:q,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"}));return r.eachAlways(t)}).then(function(){})},b([c.property({type:y,json:{read:!1}}),c.cast(k.castForReferenceSetter)],
d.prototype,"layers",null),b([c.writer("layers")],d.prototype,"writeLayers",null),b([c.property({readOnly:!0})],d.prototype,"resourceInfo",void 0),d=x=b([c.subclass("esri.Ground")],d);var x}(c.declared(e,g))})},"esri/layers/support/types":function(){define(["require","exports"],function(u,p){Object.defineProperty(p,"__esModule",{value:!0});p.isOfType=function(m,b){m=m.constructor._meta;if(!m||!m.bases)return!1;m=m.bases;var c=Array.isArray(b);return m.some(function(h){h=h.__accessorMetadata__;if(!h)return!1;
h=h.properties;if(!h||!h.type||!h.type.value)return!1;h=h.type.value;return c?-1!==b.indexOf(h):h===b})}})},"esri/support/basemapUtils":function(){define("require exports ./basemapDefinitions ../core/accessorSupport/ensureType ../core/Collection ../core/urlUtils ../core/Logger ../Basemap".split(" "),function(u,p,m,b,c,h,e,g){function n(a,f){var d;if("string"==typeof a){if(!(a in m))return f=Object.keys(m).map(function(a){return'"'+a+'"'}).join(", "),C.warn("Unable to find basemap definition for: "+
a+". Try one of these: "+f),null;f&&(d=f[a]);d||(d=g.fromId(a),f&&(f[a]=d))}else d=b["default"](g,a);return d}function k(a,b){return a.map(function(a){return b.find(function(d){var b=r(a);d=r(d);return b.type===d.type&&b.url===d.url})||a})}function l(d){return d?!d.loaded&&d.resourceInfo?a(d.resourceInfo.data):{baseLayers:w(d.baseLayers),referenceLayers:w(d.referenceLayers)}:null}function w(a){return(c.isCollection(a)?a.toArray():a).map(r)}function r(a){return{type:a.type,url:q(a.urlTemplate||a.url||
a.styleUrl)}}function a(a){return a?{baseLayers:f(a.baseMapLayers.filter(function(a){return!a.isReference})),referenceLayers:f(a.baseMapLayers.filter(function(a){return a.isReference}))}:null}function f(a){return a.map(function(a){var d;switch(a.layerType){case "VectorTileLayer":d="vector-tile";break;case "ArcGISTiledMapServiceLayer":d="tile";break;default:d="unknown"}return{type:d,url:q(a.templateUrl||a.urlTemplate||a.styleUrl||a.url)}})}function t(a,b,f){return null!=a!=(null!=b)?"not-equal":a?
y(a.baseLayers,b.baseLayers)?y(a.referenceLayers,b.referenceLayers)?"equal":f.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function y(a,b){return a.length!==b.length?!1:!a.some(function(a){return!b.some(function(d){return a.type===d.type&&a.url===d.url})})}function q(a){return a?h.normalize(a).replace(/^\s*https?:/i,"").toLowerCase():""}Object.defineProperty(p,"__esModule",{value:!0});var C=e.getLogger("esri.support.basemapUtils");p.createCache=function(){return{}};p.ensureType=
n;p.clonePreservingTiledLayers=function(a,b){void 0===b&&(b=null);a=n(a);if(!a)return null;var d=new g({id:a.id,title:a.title,baseLayers:a.baseLayers.slice(),referenceLayers:a.referenceLayers.slice()});return b&&(d.baseLayers=k(d.baseLayers,b.baseLayers),d.referenceLayers=k(d.referenceLayers,b.referenceLayers)),d.load(),d.portalItem=a.portalItem,d};p.getWellKnownBasemapId=function(d){var b=null;d=l(d);for(var f in m){var q=a(m[f]),q=t(d,q,{mustMatchReferences:!1});if("equal"===q){b=f;break}"base-layers-equal"===
q&&(b=f)}return b};p.contentEquals=function(a,b){if(a===b)return!0;a=l(a);b=l(b);return"equal"===t(a,b,{mustMatchReferences:!0})}})},"esri/support/groundUtils":function(){define("require exports ../core/accessorSupport/ensureType ../core/Logger ../Ground ../layers/ElevationLayer".split(" "),function(u,p,m,b,c,h){Object.defineProperty(p,"__esModule",{value:!0});var e=b.getLogger("esri.support.groundUtils");p.groundElevationLayers={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}};
p.ensureType=function(b){var g;"string"==typeof b?b in p.groundElevationLayers?(b=p.groundElevationLayers[b],b=new h({id:b.id,url:b.url}),g=new c({layers:[b]})):e.warn("Unable to find ground definition for: "+b+'. Try "world-elevation"'):g=m["default"](c,b);return g}})},"esri/Viewpoint":function(){define(["./core/JSONSupport","./Camera","./geometry/support/typeUtils","./geometry/support/jsonUtils"],function(u,p,m,b){var c=u.createSubclass({declaredClass:"esri.Viewpoint",properties:{rotation:{type:Number,
value:0,cast:function(b){return b%=360,0>b&&(b+=360),b},json:{write:!0}},scale:{type:Number,value:0,json:{write:!0}},targetGeometry:{value:null,types:m.types,json:{read:function(c){return b.fromJSON(c)},write:!0}},camera:{value:null,type:p,json:{write:!0}}},clone:function(){return new c({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?this.camera.clone():null})}});return c})},"esri/Camera":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./geometry/Point ./views/3d/support/mathUtils ./core/accessorSupport/decorators".split(" "),
function(u,p,m,b,c,h,e,g){return function(c){function k(b,e,a,f){b=c.call(this)||this;return b.position=null,b.heading=0,b.tilt=0,b.fov=55,b}return m(k,c),l=k,k.prototype.getDefaults=function(b){return b.position?void 0:{position:new h([0,0,0])}},k.prototype.normalizeCtorArgs=function(b,c,a,f){return b&&"object"==typeof b&&("x"in b||Array.isArray(b))?(b={position:b},null!=c&&(b.heading=c),null!=a&&(b.tilt=a),null!=f&&(b.fov=f),b):b},k.prototype.equals=function(b){return b?this.tilt===b.tilt&&this.heading===
b.heading&&this.fov===b.fov&&this.position.equals(b.position):!1},k.prototype.clone=function(){return new l({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})},b([g.property({type:h,json:{write:{isRequired:!0}}})],k.prototype,"position",void 0),b([g.property({type:Number,json:{write:{isRequired:!0}}}),g.cast(e.cyclicalDeg.normalize)],k.prototype,"heading",void 0),b([g.property({type:Number,json:{write:{isRequired:!0}}}),g.cast(function(b){return e.clamp(b,-180,180)})],
k.prototype,"tilt",void 0),b([g.property({json:{read:!1,write:!1}})],k.prototype,"fov",void 0),k=l=b([g.subclass("esri.Camera")],k);var l}(g.declared(c))})},"esri/geometry/support/typeUtils":function(){define("require exports ../../core/accessorSupport/ensureType ../Geometry ../Extent ../Multipoint ../Point ../Polyline ../Polygon".split(" "),function(u,p,m,b,c,h,e,g,n){Object.defineProperty(p,"__esModule",{value:!0});p.types={base:b,key:"type",typeMap:{extent:c,multipoint:h,point:e,polyline:g,polygon:n}};
p.ensureType=m.ensureOneOfType(p.types)})},"esri/geometry/Multipoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Geometry ./Extent ./Point ../core/lang ./support/zmUtils".split(" "),function(u,p,m,b,c,h,e,g,n,k){function l(b){return function(c,a){return null==c?a:null==a?c:b(c,a)}}u=function(h){function r(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=h.apply(this,a)||this;return a.points=
[],a.type="multipoint",a}return m(r,h),a=r,r.prototype.normalizeCtorArgs=function(a,b){if(!a&&!b)return null;var f={};Array.isArray(a)?(f.points=a,f.spatialReference=b):!a||"esri.SpatialReference"!==a.declaredClass&&null==a.wkid?(a.points&&(f.points=a.points),a.spatialReference&&(f.spatialReference=a.spatialReference),a.hasZ&&(f.hasZ=a.hasZ),a.hasM&&(f.hasM=a.hasM)):f.spatialReference=a;a=f.points&&f.points[0];return a&&(void 0===f.hasZ&&void 0===f.hasM?(f.hasZ=2<a.length,f.hasM=!1):void 0===f.hasZ?
f.hasZ=3<a.length:void 0===f.hasM&&(f.hasM=3<a.length)),f},Object.defineProperty(r.prototype,"extent",{get:function(){var a=this.points;if(!a.length)return null;for(var b,c,q,h,d=new e,x=this.hasZ,k=this.hasM,g=x?3:2,v=a[0],r=l(Math.min),Q=l(Math.max),n=v[0],m=v[1],p=v[0],v=v[1],w=0,u=a.length;u>w;w++){var G=a[w],O=G[0],H=G[1];if(n=r(n,O),m=r(m,H),p=Q(p,O),v=Q(v,H),x&&2<G.length)O=G[2],b=r(b,O),q=Q(q,O);k&&G.length>g&&(G=G[g],c=r(c,G),h=Q(h,G))}return d.xmin=n,d.ymin=m,d.xmax=p,d.ymax=v,d.spatialReference=
this.spatialReference,x?(d.zmin=b,d.zmax=q):(d.zmin=null,d.zmax=null),k?(d.mmin=c,d.mmax=h):(d.mmin=null,d.mmax=null),d},enumerable:!0,configurable:!0}),r.prototype.writePoints=function(a,b,c,q){b.points=n.clone(this.points)},r.prototype.addPoint=function(a){return this.clearCache(),k.updateSupportFromPoint(this,a),Array.isArray(a)?this.points.push(a):this.points.push(a.toArray()),this},r.prototype.clone=function(){var b={points:n.clone(this.points),spatialReference:this.spatialReference};return this.hasZ&&
(b.hasZ=!0),this.hasM&&(b.hasM=!0),new a(b)},r.prototype.getPoint=function(a){if(!this._validateInputs(a))return null;a=this.points[a];var b={x:a[0],y:a[1],spatialReference:this.spatialReference},f=2;return this.hasZ&&(b.z=a[2],f=3),this.hasM&&(b.m=a[f]),new g(b)},r.prototype.removePoint=function(a){return this._validateInputs(a)?(this.clearCache(),new g(this.points.splice(a,1)[0],this.spatialReference)):null},r.prototype.setPoint=function(a,b){return this._validateInputs(a)?(this.clearCache(),k.updateSupportFromPoint(b),
this.points[a]=b.toArray(),this):this},r.prototype.toJSON=function(a){return this.write(null,a)},r.prototype._validateInputs=function(a){return null!=a&&0<=a&&a<this.points.length},b([c.property({dependsOn:["points","hasZ","hasM","spatialReference"]})],r.prototype,"cache",void 0),b([c.property({dependsOn:["cache"]})],r.prototype,"extent",null),b([c.property({type:[[Number]],json:{write:{isRequired:!0}}})],r.prototype,"points",void 0),b([c.writer("points")],r.prototype,"writePoints",null),r=a=b([c.subclass("esri.geometry.Multipoint")],
r);var a}(c.declared(h));return u.prototype.toJSON.isDefaultToJSON=!0,u})},"esri/geometry/support/zmUtils":function(){define(["require","exports"],function(u,p){Object.defineProperty(p,"__esModule",{value:!0});p.updateSupportFromPoint=function(m,b,c){void 0===c&&(c=!1);var h=m.hasM,e=m.hasZ;Array.isArray(b)?4!==b.length||h||e?3===b.length&&c&&!h?(e=!0,h=!1):3===b.length&&h&&e&&(h=!1,e=!1):(h=!0,e=!0):(e=!e&&b.hasZ&&(!h||b.hasM),h=!h&&b.hasM&&(!e||b.hasZ));m.hasZ=e;m.hasM=h}})},"esri/geometry/Polyline":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/lang ./Geometry ./Extent ./Point ./SpatialReference ./support/zmUtils".split(" "),
function(u,p,m,b,c,h,e,g,n,k,l){function w(a){return function(b,f){return null==b?f:null==f?b:a(b,f)}}var r=w(Math.min),a=w(Math.max);u=function(f){function t(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=f.apply(this,a)||this;return a.paths=[],a.type="polyline",a}return m(t,f),e=t,t.prototype.normalizeCtorArgs=function(a,b){var d,q,f=null,c=null;return a&&!Array.isArray(a)?(f=a.paths?a.paths:null,b||(a.spatialReference?b=a.spatialReference:a.paths||(b=a)),d=a.hasZ,q=a.hasM):f=a,f=
f||[],b=b||k.WGS84,f.length&&f[0]&&null!=f[0][0]&&"number"==typeof f[0][0]&&(f=[f]),c=f[0]&&f[0][0],c&&(void 0===d&&void 0===q?(d=2<c.length,q=!1):void 0===d?d=!q&&3<c.length:void 0===q&&(q=!d&&3<c.length)),{paths:f,spatialReference:b,hasZ:d,hasM:q}},Object.defineProperty(t.prototype,"extent",{get:function(){var b=this.hasZ,f=this.hasM,d=this.spatialReference,c=this.paths,e=b?3:2;if(!c.length||!c[0].length)return null;for(var t=c[0][0],v=t[0],t=t[1],h=c[0][0],l=h[0],h=h[1],k=void 0,n=void 0,m=void 0,
p=void 0,y=[],w=0;w<c.length;w++){for(var u=c[w],H=u[0],S=H[0],H=H[1],A=u[0],K=A[0],A=A[1],E=void 0,J=void 0,L=void 0,D=void 0,N=0;N<u.length;N++){var z=u[N],B=z[0],F=z[1];if(v=r(v,B),t=r(t,F),l=a(l,B),h=a(h,F),S=r(S,B),H=r(H,F),K=a(K,B),A=a(A,F),b&&2<z.length)B=z[2],k=r(k,B),n=a(n,B),E=r(E,B),J=a(J,B);f&&z.length>e&&(D=z[e],m=r(k,D),p=a(n,D),L=r(E,D),D=a(J,D))}y.push(new g({xmin:S,ymin:H,zmin:E,mmin:L,xmax:K,ymax:A,zmax:J,mmax:D,spatialReference:d}))}c=new g;return c.xmin=v,c.ymin=t,c.xmax=l,c.ymax=
h,c.spatialReference=d,b&&(c.zmin=k,c.zmax=n),f&&(c.mmin=m,c.mmax=p),c.cache._partwise=1<y.length?y:null,c},enumerable:!0,configurable:!0}),t.prototype.writePaths=function(a,b,d,f){b.paths=h.clone(this.paths)},t.prototype.addPath=function(a){if(a){this.clearCache();var b=this.paths,d=b.length;if(Array.isArray(a[0]))b[d]=a.concat();else{for(var f=[],c=0,q=a.length;q>c;c++)f[c]=a[c].toArray();b[d]=f}return this}},t.prototype.clone=function(){var a=new e;return a.spatialReference=this.spatialReference,
a.paths=h.clone(this.paths),a.hasZ=this.hasZ,a.hasM=this.hasM,a},t.prototype.getPoint=function(a,b){if(!this._validateInputs(a,b))return null;a=this.paths[a][b];b=this.hasZ;var d=this.hasM;return b&&!d?new n(a[0],a[1],a[2],void 0,this.spatialReference):d&&!b?new n(a[0],a[1],void 0,a[2],this.spatialReference):b&&d?new n(a[0],a[1],a[2],a[3],this.spatialReference):new n(a[0],a[1],this.spatialReference)},t.prototype.insertPoint=function(a,b,d){return this._validateInputs(a,b,!0)?(this.clearCache(),l.updateSupportFromPoint(this,
d),Array.isArray(d)||(d=d.toArray()),this.paths[a].splice(b,0,d),this):this},t.prototype.removePath=function(a){if(!this._validateInputs(a,null))return null;this.clearCache();a=this.paths.splice(a,1)[0];var b=this.spatialReference;return a.map(function(a){return new n(a,b)})},t.prototype.removePoint=function(a,b){return this._validateInputs(a,b)?(this.clearCache(),new n(this.paths[a].splice(b,1)[0],this.spatialReference)):null},t.prototype.setPoint=function(a,b,d){return this._validateInputs(a,b)?
(this.clearCache(),l.updateSupportFromPoint(this,d),Array.isArray(d)||(d=d.toArray()),this.paths[a][b]=d,this):this},t.prototype._validateInputs=function(a,b,d){if((void 0===d&&(d=!1),null==a||null==b)||0>a||a>=this.paths.length)return!1;a=this.paths[a];return d&&0>b||b>a.length?!1:0>b||b>=a.length?!1:!0},t.prototype.toJSON=function(a){return this.write(null,a)},b([c.property({dependsOn:["hasM","hasZ","paths"]})],t.prototype,"cache",void 0),b([c.property({dependsOn:["cache"],readOnly:!0})],t.prototype,
"extent",null),b([c.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],t.prototype,"paths",void 0),b([c.writer("paths")],t.prototype,"writePaths",null),t=e=b([c.subclass("esri.geometry.Polyline")],t);var e}(c.declared(e));return u.prototype.toJSON.isDefaultToJSON=!0,u})},"esri/geometry/Polygon":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/lang ./Geometry ./Extent ./Point ./SpatialReference ./support/webMercatorUtils ./support/zmUtils ./support/coordsUtils".split(" "),
function(u,p,m,b,c,h,e,g,n,k,l,w,r){function a(a){return function(b,f){return null==b?f:null==f?b:a(b,f)}}var f=a(Math.min),t=a(Math.max);u=function(a){function e(){for(var b=[],f=0;f<arguments.length;f++)b[f]=arguments[f];b=a.apply(this,b)||this;return b.rings=[],b.type="polygon",b}return m(e,a),p=e,e.createEllipse=function(a){var b=a.center.x,d=a.center.y,f=a.center.z,c=a.center.m,e=a.center.hasZ,t=a.center.hasM,h=a.longAxis,k=a.shortAxis,l=a.numberOfPoints;a=a.view;for(var g=[],q=2*Math.PI/l,n=
e?3:2,r=0;l>r;r++){var m=a.toMap(h*Math.cos(r*q)+b,k*Math.sin(r*q)+d),m=[m.x,m.y];e&&(m[2]=f);t&&(m[n]=c);g.push(m)}g.push(g[0]);return new p({rings:[g],spatialReference:a.spatialReference})},e.createCircle=function(a){return p.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,view:a.view})},e.fromExtent=function(a){var b=a.clone().normalize();a=a.spatialReference;var d=!1,f=!1;b.map(function(a){a.hasZ&&(d=!0);a.hasM&&(f=!0)});b={rings:b.map(function(a){var b=
[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(d&&a.hasZ)for(var c=(a.zmax-a.zmin)/2,e=0;e<b.length;e++)b[e].push(c);if(f&&a.hasM)for(a=(a.mmax-a.mmin)/2,e=0;e<b.length;e++)b[e].push(a);return b}),spatialReference:a};return d&&(b.hasZ=!0),f&&(b.hasM=!0),new p(b)},e.prototype.normalizeCtorArgs=function(a,b){var d,f,c=null,e=null;return a&&!Array.isArray(a)?(c=a.rings?a.rings:null,b||(a.spatialReference?b=a.spatialReference:a.rings||(b=a)),d=a.hasZ,f=a.hasM):c=
a,c=c||[],b=b||k.WGS84,c.length&&c[0]&&null!=c[0][0]&&"number"==typeof c[0][0]&&(c=[c]),e=c[0]&&c[0][0],e&&(void 0===d&&void 0===f?(d=2<e.length,f=!1):void 0===d?d=!f&&3<e.length:void 0===f&&(f=!d&&3<e.length)),{rings:c,spatialReference:b,hasZ:d,hasM:f}},Object.defineProperty(e.prototype,"centroid",{get:function(){var a=r.ringsCentroid([],this.rings,this.hasZ);if(isNaN(a[0])||isNaN(a[1])||this.hasZ&&isNaN(a[2]))return null;var b=new n;return b.x=a[0],b.y=a[1],b.spatialReference=this.spatialReference,
this.hasZ&&(b.z=a[2]),b},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extent",{get:function(){var a=this.hasZ,b=this.hasM,c=this.spatialReference,e=this.rings,h=a?3:2;if(!e.length||!e[0].length)return null;for(var l=e[0][0],k=l[0],l=l[1],q=e[0][0],r=q[0],q=q[1],n=void 0,m=void 0,p=void 0,w=void 0,y=[],u=0;u<e.length;u++){for(var C=e[u],A=C[0],K=A[0],A=A[1],E=C[0],J=E[0],E=E[1],L=void 0,D=void 0,N=void 0,z=void 0,B=0;B<C.length;B++){var F=C[B],I=F[0],R=F[1];if(k=f(k,I),l=f(l,
R),r=t(r,I),q=t(q,R),K=f(K,I),A=f(A,R),J=t(J,I),E=t(E,R),a&&2<F.length)I=F[2],n=f(n,I),m=t(m,I),L=f(L,I),D=t(D,I);b&&F.length>h&&(z=F[h],p=f(n,z),w=t(m,z),N=f(L,z),z=t(D,z))}y.push(new g({xmin:K,ymin:A,zmin:L,mmin:N,xmax:J,ymax:E,zmax:D,mmax:z,spatialReference:c}))}e=new g;return e.xmin=k,e.ymin=l,e.xmax=r,e.ymax=q,e.spatialReference=c,a&&(e.zmin=n,e.zmax=m),b&&(e.mmin=p,e.mmax=w),e.cache._partwise=1<y.length?y:null,e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSelfIntersecting",
{get:function(){return r.isSelfIntersecting(this.rings)},enumerable:!0,configurable:!0}),e.prototype.writePaths=function(a,b,f,c){b.rings=h.clone(this.rings)},e.prototype.addRing=function(a){if(a){this.clearCache();var b=this.rings,d=b.length;if(Array.isArray(a[0]))b[d]=a.concat();else{for(var f=[],c=0,e=a.length;e>c;c++)f[c]=a[c].toArray();b[d]=f}return this}},e.prototype.clone=function(){var a=new p;return a.spatialReference=this.spatialReference,a.rings=h.clone(this.rings),a.hasZ=this.hasZ,a.hasM=
this.hasM,a},e.prototype.contains=function(a){return a?(l.canProject(a,this.spatialReference)&&(a=l.project(a,this.spatialReference)),r.contains(this.rings,r.geometryToCoordinates(a))):!1},e.prototype.isClockwise=function(a){var b,d=this;return b=Array.isArray(a[0])?a:a.map(function(a){return d.hasZ?d.hasM?[a.x,a.y,a.z,a.m]:[a.x,a.y,a.z]:[a.x,a.y]}),r.isClockwise(b,this.hasM,this.hasZ)},e.prototype.getPoint=function(a,b){if(!this._validateInputs(a,b))return null;a=this.rings[a][b];b=this.hasZ;var d=
this.hasM;return b&&!d?new n(a[0],a[1],a[2],void 0,this.spatialReference):d&&!b?new n(a[0],a[1],void 0,a[2],this.spatialReference):b&&d?new n(a[0],a[1],a[2],a[3],this.spatialReference):new n(a[0],a[1],this.spatialReference)},e.prototype.insertPoint=function(a,b,f){return this._validateInputs(a,b,!0)?(this.clearCache(),w.updateSupportFromPoint(this,f),Array.isArray(f)||(f=f.toArray()),this.rings[a].splice(b,0,f),this):this},e.prototype.removePoint=function(a,b){return this._validateInputs(a,b)?(this.clearCache(),
new n(this.rings[a].splice(b,1)[0],this.spatialReference)):null},e.prototype.removeRing=function(a){if(!this._validateInputs(a,null))return null;this.clearCache();a=this.rings.splice(a,1)[0];var b=this.spatialReference;return a.map(function(a){return new n(a,b)})},e.prototype.setPoint=function(a,b,f){return this._validateInputs(a,b)?(this.clearCache(),w.updateSupportFromPoint(this,f),Array.isArray(f)||(f=f.toArray()),this.rings[a][b]=f,this):this},e.prototype._validateInputs=function(a,b,f){if((void 0===
f&&(f=!1),null==a||null==b)||0>a||a>=this.rings.length)return!1;a=this.rings[a];return f&&0>b||b>a.length?!1:0>b||b>=a.length?!1:!0},e.prototype.toJSON=function(a){return this.write(null,a)},b([c.property({dependsOn:["hasM","hasZ","rings"]})],e.prototype,"cache",void 0),b([c.property({readOnly:!0,dependsOn:["cache"]})],e.prototype,"centroid",null),b([c.property({dependsOn:["cache"],readOnly:!0})],e.prototype,"extent",null),b([c.property({dependsOn:["cache"],readOnly:!0})],e.prototype,"isSelfIntersecting",
null),b([c.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],e.prototype,"rings",void 0),b([c.writer("rings")],e.prototype,"writePaths",null),e=p=b([c.subclass("esri.geometry.Polygon")],e);var p}(c.declared(e));return u.prototype.toJSON.isDefaultToJSON=!0,u})},"esri/geometry/support/jsonUtils":function(){define("require exports ../Extent ../Multipoint ../Point ../Polygon ../Polyline".split(" "),function(u,p,m,b,c,h,e){function g(k){return k?void 0!==k.x&&void 0!==k.y?c.fromJSON(k):void 0!==
k.paths?e.fromJSON(k):void 0!==k.rings?h.fromJSON(k):void 0!==k.points?b.fromJSON(k):void 0!==k.xmin&&void 0!==k.ymin&&void 0!==k.xmax&&void 0!==k.ymax?m.fromJSON(k):null:null}Object.defineProperty(p,"__esModule",{value:!0});p.fromJson=function(b){try{throw Error("fromJson is deprecated, use fromJSON instead");}catch(l){console.warn(l.stack)}return g(b)};p.fromJSON=g;p.getJsonType=function(k){return k instanceof c?"esriGeometryPoint":k instanceof e?"esriGeometryPolyline":k instanceof h?"esriGeometryPolygon":
k instanceof m?"esriGeometryEnvelope":k instanceof b?"esriGeometryMultipoint":null};var n={esriGeometryPoint:c,esriGeometryPolyline:e,esriGeometryPolygon:h,esriGeometryEnvelope:m,esriGeometryMultipoint:b};p.getGeometryType=function(b){return b&&n[b]||null}})},"esri/portal/support/geometryServiceUtils":function(){define("require exports ../Portal ../PortalItem ../../config ../../tasks/GeometryService ../../tasks/support/ProjectParameters ../../core/promiseUtils ../../core/Error".split(" "),function(u,
p,m,b,c,h,e,g,n){function k(e){if(void 0===e&&(e=null),c.geometryServiceUrl)return g.resolve(new h({url:c.geometryServiceUrl}));if(!e)return g.reject(new n("internal:geometry-service-url-not-configured"));var l;return e.isInstanceOf(b)?l=e.portal||m.getDefault():e.isInstanceOf(m)&&(l=e),l.load().then(function(b){if(b.helperServices&&b.helperServices.geometry&&b.helperServices.geometry.url)return g.resolve(new h({url:b.helperServices.geometry.url}));throw new n("internal:geometry-service-url-not-configured");
})}Object.defineProperty(p,"__esModule",{value:!0});p.create=k;p.projectGeometry=function(b,c,h){return void 0===h&&(h=null),k(h).then(function(a){var f=new e;return f.geometries=[b],f.outSpatialReference=c,a.project(f)}).then(function(a){return a&&Array.isArray(a)&&1===a.length?a[0]:g.reject()})}})},"esri/tasks/GeometryService":function(){define("../core/kebabDictionary ../core/accessorSupport/ensureType ../geometry/Extent ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ../geometry/support/jsonUtils ../request ./Task ./support/ProjectParameters dojo/_base/lang".split(" "),
function(u,p,m,b,c,h,e,g,n,k,l){var w=u({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"}),r=p.ensureType(k);u=n.createSubclass({declaredClass:"esri.tasks.GeometryService",areasAndLengths:function(a,b){a={query:l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/areasAndLengths",a).then(function(a){return a.data})},autoComplete:function(a,
b,c){var f=a[0].spatialReference;a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),polygons:JSON.stringify(this._encodeGeometries(a).geometries),polylines:JSON.stringify(this._encodeGeometries(b).geometries)}),callbackParamName:"callback"};return(this.requestOptions||c)&&(a=l.mixin({},this.requestOptions,c,a)),g(this.parsedUrl.path+"/autoComplete",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new h({spatialReference:f,rings:a.rings})})})},
buffer:function(a,b){var f=l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),c=a.outSpatialReference||a.geometries[0].spatialReference;a={query:f,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/buffer",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new h({spatialReference:c,rings:a.rings})})})},cut:function(a,b,c){var f=a[0].spatialReference,h=a.map(function(a){return a.toJSON()});a={query:l.mixin({},
this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),target:JSON.stringify({geometryType:e.getJsonType(a[0]),geometries:h}),cutter:JSON.stringify(b.toJSON())}),callbackParamName:"callback"};return(this.requestOptions||c)&&(a=l.mixin({},this.requestOptions,c,a)),g(this.parsedUrl.path+"/cut",a).then(function(a){a=a.data;return{cutIndexes:a.cutIndexes,geometries:(a.geometries||[]).map(function(a){return e.fromJSON(a).set("spatialReference",f)})}})},convexHull:function(a,b){var f=a[0].spatialReference;
a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/convexHull",a).then(function(a){return e.fromJSON(a.data.geometry).set("spatialReference",f)})},densify:function(a,b){var f=l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),c=a.geometries[0].spatialReference;a={query:f,callbackParamName:"callback"};
return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/densify",a).then(function(a){return(a.data.geometries||[]).map(function(a){return e.fromJSON(a).set("spatialReference",c)})})},difference:function(a,b,c){var f=a[0].spatialReference;a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),geometry:JSON.stringify({geometryType:e.getJsonType(b),geometry:b.toJSON()})}),callbackParamName:"callback"};
return(this.requestOptions||c)&&(a=l.mixin({},this.requestOptions,c,a)),g(this.parsedUrl.path+"/difference",a).then(function(a){return(a.data.geometries||[]).map(function(a){return e.fromJSON(a).set("spatialReference",f)})})},distance:function(a,b){a={query:l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/distance",a).then(this._handleDistanceResponse)},fromGeoCoordinateString:function(a,
b){var f={};l.isObject(a.sr)?f.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):f.sr=a.sr;f.strings=JSON.stringify(a.strings);f.conversionType=w.toJSON(a.conversionType||"mgrs");f.conversionMode=a.conversionMode;a={query:l.mixin({},this.parsedUrl.query,{f:"json"},f),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/fromGeoCoordinateString",a).then(this._handleFromGeoCoordinateResponse)},generalize:function(a,b){var f=l.mixin({},
this.parsedUrl.query,{f:"json"},a.toJSON()),c=a.geometries[0].spatialReference;a={query:f,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/generalize",a).then(function(a){return(a.data.geometries||[]).map(function(a){return e.fromJSON(a).set("spatialReference",c)})})},intersect:function(a,b,c){var f=a[0].spatialReference;a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),
geometry:JSON.stringify({geometryType:e.getJsonType(b),geometry:b.toJSON()})}),callbackParamName:"callback"};return(this.requestOptions||c)&&(a=l.mixin({},this.requestOptions,c,a)),g(this.parsedUrl.path+"/intersect",a).then(function(a){return(a.data.geometries||[]).map(function(a){return e.fromJSON(a).set("spatialReference",f)})})},lengths:function(a,b){a={query:l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,
b,a)),g(this.parsedUrl.path+"/lengths",a).then(function(a){return a.data})},labelPoints:function(a,b){var f=a.map(function(a){return a.toJSON()}),c=a[0].spatialReference;a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:c.wkid?c.wkid:JSON.stringify(c.toJSON()),polygons:JSON.stringify(f)}),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/labelPoints",a).then(function(a){return(a.data.labelPoints||[]).map(function(a){return e.fromJSON(a).set("spatialReference",
c)})})},offset:function(a,b){var c=l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),f=a.geometries[0].spatialReference;a={query:c,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/offset",a).then(function(a){return(a.data.geometries||[]).map(function(a){return e.fromJSON(a).set("spatialReference",f)})})},project:function(a,b){a=r(a);var c=l.mixin({},a.toJSON(),this.parsedUrl.query,{f:"json"}),f=a.outSpatialReference,
h=e.getJsonType(a.geometries[0]),k=this._decodeGeometries;a={query:c,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/project",a).then(function(a){return k(a.data,h,f)})},relation:function(a,b){a={query:l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/relation",a).then(this._handleRelationResponse)},
reshape:function(a,b,c){var f=a.spatialReference;a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),target:JSON.stringify({geometryType:e.getJsonType(a),geometry:a.toJSON()}),reshaper:JSON.stringify(b.toJSON())}),callbackParamName:"callback"};return(this.requestOptions||c)&&(a=l.mixin({},this.requestOptions,c,a)),g(this.parsedUrl.path+"/reshape",a).then(function(a){return e.fromJSON(a.data.geometry).set("spatialReference",f)})},simplify:function(a,b){var c=a[0].spatialReference,
f=l.mixin({},this.parsedUrl.query,{f:"json",sr:c.wkid?c.wkid:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),h=e.getJsonType(a[0]),k=this._decodeGeometries;a={query:f,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/simplify",a).then(function(a){return k(a.data,h,c)})},toGeoCoordinateString:function(a,b){var c={};l.isObject(a.sr)?c.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):c.sr=a.sr;c.coordinates=
JSON.stringify(a.coordinates);c.conversionType=w.toJSON(a.conversionType||"mgrs");c.conversionMode=a.conversionMode;c.numOfDigits=a.numOfDigits;c.rounding=a.rounding;c.addSpaces=a.addSpaces;a={query:l.mixin({},this.parsedUrl.query,{f:"json"},c),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/toGeoCoordinateString",a).then(this._handleToGeoCoordinateResponse)},trimExtend:function(a,b){var f=l.mixin({},this.parsedUrl.query,
{f:"json"},a.toJSON()),e=a.sr;a={query:f,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/trimExtend",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new c({spatialReference:e,paths:a.paths})})})},union:function(a,b){var c=a[0].spatialReference;a={query:l.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),callbackParamName:"callback"};
return(this.requestOptions||b)&&(a=l.mixin({},this.requestOptions,b,a)),g(this.parsedUrl.path+"/union",a).then(function(a){return e.fromJSON(a.data.geometry).set("spatialReference",c)})},_handleRelationResponse:function(a){return a.data.relations},_handleDistanceResponse:function(a){return a=a.data,a&&a.distance},_handleToGeoCoordinateResponse:function(a){return a.data.strings},_handleFromGeoCoordinateResponse:function(a){return a.data.coordinates},_encodeGeometries:function(a){var b,c=[],h=a.length;
for(b=0;h>b;b++)c.push(a[b].toJSON());return{geometryType:e.getJsonType(a[0]),geometries:c}},_decodeGeometries:function(a,b,c){var f=e.getGeometryType(b);a=a.geometries;var h=[],k={spatialReference:c.toJSON()},d=l.mixin;return a.forEach(function(a,b){h[b]=new f(d(a,k))}),h},_toProjectGeometry:function(a){var b=a.spatialReference.toJSON();return a instanceof m?new h({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:b}):new c({paths:[[].concat(a.points)],
spatialReference:b})},_fromProjectedGeometry:function(a,c,e){return"extent"===c?(a=a.rings[0],new m(a[0][0],a[0][1],a[2][0],a[2][1],e)):new b({points:a.paths[0],spatialReference:e.toJSON()})}});return l.mixin(u,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,
UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,
UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,
UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",
UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"}),u})},"esri/tasks/Task":function(){define(["dojo/_base/lang","../core/Accessor","../core/urlUtils"],function(u,p,m){return p.createSubclass({declaredClass:"esri.tasks.Task",normalizeCtorArgs:function(b,c){if("string"!=typeof b)return b;var h={};return b&&(h.url=b),c&&u.mixin(h,c),h},properties:{normalization:{value:!0},parsedUrl:{value:null,readOnly:!0,dependsOn:["url"],
get:function(){return this._parseUrl(this.url)}},requestOptions:{value:null},url:{value:null,type:String}},_parseUrl:function(b){return b?m.urlToObject(b):null},_useSSL:function(){var b=this.parsedUrl,c=/^http:/i;this.url&&this.set("url",this.url.replace(c,"https:"));b&&b.path&&(b.path=b.path.replace(c,"https:"))},_encode:function(b,c,h){var e,g,n,k,l,m={};for(n in b)if("declaredClass"!==n&&(e=b[n],g=typeof e,null!==e&&void 0!==e&&"function"!==g))if(u.isArray(e))for(m[n]=[],l=e.length,k=0;l>k;k++)m[n][k]=
this._encode(e[k]);else"object"===g?e.toJSON&&(k=e.toJSON(h&&h[n]),"esri.tasks.support.FeatureSet"===e.declaredClass&&k.spatialReference&&(k.sr=k.spatialReference,delete k.spatialReference),m[n]=c?k:JSON.stringify(k)):m[n]=e;return m}})})},"esri/tasks/support/ProjectParameters":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/lang ../../geometry/support/jsonUtils ../../core/JSONSupport ../../core/Logger".split(" "),
function(u,p,m,b,c,h,e,g,n){var k=n.getLogger("esri.tasks.support.ProjectParameters");return function(l){function g(b){b=l.call(this)||this;return b.geometries=null,b.outSpatialReference=null,b.transformation=null,b.transformForward=null,b}return m(g,l),Object.defineProperty(g.prototype,"outSR",{get:function(){return k.warn("ProjectParameters.outSR is deprecated. Use outSpatialReference instead."),this.outSpatialReference},set:function(b){k.warn("ProjectParameters.outSR is deprecated. Use outSpatialReference instead.");
this.outSpatialReference=b},enumerable:!0,configurable:!0}),g.prototype.toJSON=function(){var b=this.geometries.map(function(a){return a.toJSON()}),a=this.geometries[0],c={};return c.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),c.inSR=a.spatialReference.wkid||JSON.stringify(a.spatialReference.toJSON()),c.geometries=JSON.stringify({geometryType:e.getJsonType(a),geometries:b}),this.transformation&&(c.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),
h.isDefined(this.transformForward)&&(c.transformForward=this.transformForward),c},b([c.property()],g.prototype,"geometries",void 0),b([c.property({json:{read:{source:"outSR"}}})],g.prototype,"outSpatialReference",void 0),b([c.property({json:{read:!1}})],g.prototype,"outSR",null),b([c.property()],g.prototype,"transformation",void 0),b([c.property()],g.prototype,"transformForward",void 0),g=b([c.subclass("esri.tasks.support.ProjectParameters")],g)}(c.declared(g))})},"esri/webmap/InitialViewProperties":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Viewpoint ../core/Accessor ../geometry/SpatialReference ../core/accessorSupport/decorators".split(" "),
function(u,p,m,b,c,h,e,g){return function(h){function k(b){b=h.call(this,b)||this;return b.spatialReference=null,b.viewpoint=null,b}return m(k,h),l=k,k.prototype.clone=function(){return new l({spatialReference:this.spatialReference?this.spatialReference.clone():null,viewpoint:this.viewpoint?this.viewpoint.clone():null})},b([g.shared("esri.webmap.InitialViewProperties")],k.prototype,"declaredClass",void 0),b([g.property({value:null,type:e})],k.prototype,"spatialReference",void 0),b([g.property({value:null,
type:c})],k.prototype,"viewpoint",void 0),k=l=b([g.subclass()],k);var l}(g.declared(h))})},"*noref":1}});
define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./Map ./Viewpoint ./core/Error ./core/JSONSupport ./core/Loadable ./core/promiseUtils ./core/requireUtils ./core/Logger ./geometry/SpatialReference ./geometry/support/webMercatorUtils ./portal/Portal ./portal/PortalItem ./portal/support/geometryServiceUtils ./tasks/support/ProjectParameters ./webmap/InitialViewProperties ./core/accessorSupport/decorators dojo/_base/lang".split(" "),function(u,p,m,b,c,h,e,
g,n,k,l,w,r,a,f,t,y,q,C,d,x){var M=w.getLogger("esri.WebMap");return function(c){function g(a){a=c.call(this)||this;return a.applicationProperties=null,a.authoringApp=null,a.authoringAppVersion=null,a.bookmarks=null,a.initialViewProperties=null,a.portalItem=null,a.presentation=null,a.sourceVersion=null,a.tables=null,a.widgets=null,a}return m(g,c),n=g,g.prototype.initialize=function(){if(this.when()["catch"](function(a){M.error("#load()","Failed to load web map",a)}),this.resourceInfo){var a=void 0;
try{a=this._validateJSON(this.resourceInfo)}catch(T){return void this.addResolvingPromise(k.reject(T))}this.read(a)}},g.prototype.readInitialViewProperties=function(a,b){a={};return b.spatialReference&&(a.spatialReference=r.fromJSON(b.spatialReference)),new C(a)},g.prototype.readSourceVersion=function(a,b){a=b.version.split(".");b=a[1];return{major:parseInt(a[0],10),minor:parseInt(b,10)}},g.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},g.prototype.toJSON=
function(){throw new e("internal:not-yet-implemented","WebMap.toJSON is not yet implemented");},g.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new n({resourceInfo:a})},g.prototype._loadFromSource=function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):k.resolve(null)},g.prototype._loadFromItem=function(a){var b=this;return a.load().otherwise(function(a){throw new e("webmap:load-portal-item",
"Failed to load portal item",{error:a});}).then(function(){if("Web Map"!==a.type)throw new e("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:a.type});}).then(function(){return a.fetchData()}).then(function(c){return b.resourceInfo=c,b._readAndLoadFromJSON(c,{origin:"web-map",portal:a.portal||f.getDefault()})}).then(function(){return b._getInitialExtent()}).then(function(a){if(a){var c=b.initialViewProperties?b.initialViewProperties.clone():new C;c.viewpoint=
new h;c.viewpoint.targetGeometry=a;b.initialViewProperties=c}})},g.prototype._readAndLoadFromJSON=function(a,b){a=this._validateJSON(a);return this.read(a,b),this._loadFromJSON(a,b)},g.prototype._validateJSON=function(a){a=this._sanitizeJSON(a);var b=this._validateVersion(a.version);return a.version=b.major+"."+b.minor,a},g.prototype._sanitizeJSON=function(a){return{authoringApp:a.authoringApp||"",authoringAppVersion:a.authoringAppVersion||"",applicationProperties:a.applicationProperties,baseMap:a.baseMap,
bookmarks:a.bookmarks,operationalLayers:a.operationalLayers,presentation:a.presentation,spatialReference:a.spatialReference,tables:a.tables,version:a.version||"0.0",widgets:a.widgets}},g.prototype._validateVersion=function(a){var b=a.split("."),c=b[0],b=b[1],d=/^\s*\d+\s*$/;if(!d.test(c))throw new e("webmap:invalid-version","Expected major version to be a number, but got '"+a+"'",{version:a});if(!d.test(b))throw new e("webmap:invalid-version","Expected minor version to be a number, but got '"+a+"'",
{version:a});c=parseInt(c,10);b=parseInt(b,10);if(2!==c)throw new e("webmap:unsupported-version","Required major version is '2', but got '"+c+"'",{version:a});return{major:c,minor:b}},g.prototype._loadFromJSON=function(a,b){var c=this,d={context:x.mixin({},b,{layerContainerType:"operational-layers"})};return this.portalItem&&(d.context.portal=this.portalItem.portal||f.getDefault()),l.when(u,"./portal/support/layersCreator").then(function(b){var e=[],f=a.operationalLayers;return f&&f.length&&e.push.apply(e,
b.populateOperationalLayers(c.layers,f,d)),k.eachAlways(e).then(function(){})})},g.prototype._getInitialExtent=function(){var b=null,c=this.initialViewProperties&&this.initialViewProperties.spatialReference,d=this.portalItem&&this.portalItem.extent;if(c&&d)if(c.isWGS84)b=d.clone();else{if(!c.isWebMercator)return y.create(this.portalItem).then(function(a){var b=new q;return b.geometries=[d],b.outSpatialReference=c,a.project(b)}).then(function(a){return a[0]}).otherwise(function(a){return console.log("Error projecting item's extent:",
a),null});b=a.geographicToWebMercator(d)}return k.resolve(b)},b([d.property()],g.prototype,"applicationProperties",void 0),b([d.property()],g.prototype,"authoringApp",void 0),b([d.property()],g.prototype,"authoringAppVersion",void 0),b([d.property({json:{read:{source:"baseMap"}}})],g.prototype,"basemap",void 0),b([d.property()],g.prototype,"bookmarks",void 0),b([d.property({type:C})],g.prototype,"initialViewProperties",void 0),b([d.reader("initialViewProperties",["spatialReference"])],g.prototype,
"readInitialViewProperties",null),b([d.property({type:t})],g.prototype,"portalItem",void 0),b([d.property()],g.prototype,"presentation",void 0),b([d.property()],g.prototype,"resourceInfo",void 0),b([d.property({readOnly:!0})],g.prototype,"sourceVersion",void 0),b([d.reader("sourceVersion",["version"])],g.prototype,"readSourceVersion",null),b([d.property()],g.prototype,"tables",void 0),b([d.property()],g.prototype,"widgets",void 0),g=n=b([d.subclass("esri.WebMap")],g);var n}(d.declared(c,n,g))});