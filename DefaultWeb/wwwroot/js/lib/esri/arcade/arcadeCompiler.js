//>>built
define("require exports ../geometry/Polygon ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../geometry/SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/geomsync ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),function(la,r,Q,R,S,T,U,V,d,h,t,y,W,X,Y,Z,aa,ba,D,ca,da){function m(a,b,c){try{return c(a,null,b)}catch(f){throw f;
}}function g(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return ea(a,b);case "VariableDeclaration":for(var c=[],f=0;f<b.declarations.length;f++)c.push(g(a,b.declarations[f]));return c.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return K(a,b);case "FunctionDeclaration":var d=b.id.name.toLowerCase(),u={applicationCache:void 0===a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,
symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<u.depthCounter)throw Error("Exceeded maximum function depth");for(var c="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",A=0;A<b.params.length;A++){var l=b.params[A].name.toLowerCase(),E=G(l,a);u.localScope._SymbolsMap[l]=E;c+="lscope['"+E+"']\x3darguments["+A.toString()+"];\n"}(c+=K(u,b.body)+"\n return lastStatement; }, runtimeCtx))",
c+="\n lastStatement \x3d lc.voidOperation; \n",void 0!==a.globalScope[d])?f="gscope['"+d+"']\x3d"+c:void 0!==a.globalScope._SymbolsMap[d]?f="gscope['"+a.globalScope._SymbolsMap[d]+"']\x3d"+c:(E=G(d,a),f=(a.globalScope._SymbolsMap[d]=E,"gscope['"+E+"']\x3d"+c));return f;case "ReturnStatement":var L;L=null===b.argument?"return lc.voidOperation;":"return "+g(a,b.argument)+";";return L;case "IfStatement":if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(h.nodeErrorMessage(b.test,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var fa=g(a,b.test),m=B(a),r="var "+m+" \x3d "+fa+";\n if ("+m+" \x3d\x3d\x3d true) {\n"+M(a,b.consequent)+"\n }\n";return r+=null!==b.alternate?"else if ("+m+"\x3d\x3d\x3dfalse)   { \n"+M(a,b.alternate)+"}\n":"else if ("+m+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n",r+="else { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";case "ExpressionStatement":return"AssignmentExpression"===b.expression.type?
"lastStatement \x3d lc.voidOperation; "+g(a,b.expression)+" \n ":"lastStatement \x3d "+g(a,b.expression)+";";case "AssignmentExpression":return ga(a,b);case "UpdateExpression":return ha(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":c="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(c+=g(a,b.init));var p=B(a),t=B(a);return c+="var "+p+" \x3d true;",c+="\n do { ",null!==b.update&&(c+=" if ("+p+"\x3d\x3d\x3dfalse) {\n "+g(a,b.update)+
"  \n}\n "+p+"\x3dfalse; \n"),null!==b.test&&(c+="var "+t+" \x3d "+g(a,b.test)+";",c+="if ("+t+"\x3d\x3d\x3dfalse) { break; } else if ("+t+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n"),c+=g(a,b.body),null!==b.update&&(c+="\n "+g(a,b.update)),c+="\n"+p+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;";case "ForInStatement":var w=B(a),n=B(a),v=B(a),k="var "+w+" \x3d "+g(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&
(k+=g(a,b.left));var x="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,x=x.toLowerCase(),c="";return null!==a.localScope&&(void 0!==a.localScope[x]?c="lscope['"+x+"']":void 0!==a.localScope._SymbolsMap[x]&&(c="lscope['"+a.localScope._SymbolsMap[x]+"']")),""===c&&(void 0!==a.globalScope[x]?c="gscope['"+x+"']":void 0!==a.globalScope._SymbolsMap[x]&&(c="gscope['"+a.globalScope._SymbolsMap[x]+"']")),k+="if ("+w+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ",
k+="else if (lc.isArray("+w+") || lc.isString("+w+")) {",k+="var "+n+"\x3d"+w+".length; \n",k+="for(var "+v+"\x3d0; "+v+"\x3c"+n+"; "+v+"++) {\n",k+=c+"\x3d"+v+";\n",k+=g(a,b.body),k+="\n}\n",k+=" lastStatement \x3d lc.voidOperation; \n",k+=" \n}\n",k+="else if (lc.isImmutableArray("+w+")) {",k+="var "+n+"\x3d"+w+".length(); \n",k+="for(var "+v+"\x3d0; "+v+"\x3c"+n+"; "+v+"++) {\n",k+=c+"\x3d"+v+";\n",k+=g(a,b.body),k+="\n}\n",k+=" lastStatement \x3d lc.voidOperation; \n",k+=" \n}\n",k+="else if (( "+
w+" instanceof lang.Dictionary) || ( "+w+" instanceof lang.Feature)) {",k+="var "+n+"\x3d"+w+".keys(); \n",k+="for(var "+v+"\x3d0; "+v+"\x3c"+n+".length; "+v+"++) {\n",k+=c+"\x3d"+n+"["+v+"];\n",k+=g(a,b.body),k+="\n}\n",k+=" lastStatement \x3d lc.voidOperation; \n",k+=" \n}\n",k+="else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return ia(a,b);case "MemberExpression":var y;try{c=void 0,y=(c=!0===b.computed?g(a,b.property):"'"+b.property.name+"'","lang.member("+g(a,b.object)+","+
c+")")}catch(q){throw q;}return y;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(h.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(h.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var z=b.callee.name.toLowerCase(),f="";if(null!==a.localScope&&(void 0!==a.localScope[z]?f="lscope['"+z+"']":void 0!==a.localScope._SymbolsMap[z]&&(f="lscope['"+a.localScope._SymbolsMap[z]+
"']")),""===f&&(void 0!==a.globalScope[z]?f="gscope['"+z+"']":void 0!==a.globalScope._SymbolsMap[z]&&(f="gscope['"+a.globalScope._SymbolsMap[z]+"']")),""!==f){d="[";for(u=0;u<b.arguments.length;u++)0<u&&(d+=", "),d+=g(a,b.arguments[u]);c=(d+="]","lang.callfunc("+f+","+d+",runtimeCtx)")}else throw Error(h.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(q){throw q;}return c;case "UnaryExpression":var C;try{C="lang.unary("+g(a,b.argument)+",'"+b.operator+"')"}catch(q){throw q;}return C;case "BinaryExpression":var D;
try{D="lang.binary("+g(a,b.left)+","+g(a,b.right)+",'"+b.operator+"')"}catch(q){throw q;}return D;case "LogicalExpression":var F;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(h.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(h.nodeErrorMessage(b.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("\x26\x26"===b.operator||"||"===b.operator)F=
"(lang.logicalCheck("+g(a,b.left)+") "+b.operator+" lang.logicalCheck("+g(a,b.right)+"))";else throw Error(h.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}catch(q){throw q;}return F;case "ConditionalExpression":throw Error(h.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{c=[];for(f=0;f<b.elements.length;f++)"Literal"===b.elements[f].type?c.push(g(a,b.elements[f])):c.push("lang.aCheck("+g(a,b.elements[f])+",'ArrayExpression')");A="["+c.join(",")+"]"}catch(q){throw q;
}return A;case "ObjectExpression":c="lang.dictionary([";for(f=0;f<b.properties.length;f++){var H=b.properties[f],I="Identifier"===H.key.type?"'"+H.key.name+"'":g(a,H.key),J=g(a,H.value);0<f&&(c+=",");c+="lang.strCheck("+I+",'ObjectExpression'),lang.aCheck("+J+", 'ObjectExpression')"}return c+="])";case "Property":throw Error("Should not get here");case "Array":throw Error(h.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(h.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(q){throw q;
}}function ha(a,b){var c=null,d="";if("MemberExpression"===b.argument.type)return c=g(a,b.argument.object),d=!0===b.argument.computed?g(a,b.argument.property):"'"+b.argument.property.name+"'","lang.memberupdate("+c+","+d+",'"+b.operator+"',"+b.prefix+")";if(c=b.argument.name.toLowerCase(),null!==a.localScope){if(void 0!==a.localScope[c])return"lang.update(lscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.localScope._SymbolsMap[c])return"lang.update(lscope, '"+a.localScope._SymbolsMap[c]+
"','"+b.operator+"',"+b.prefix+")"}if(void 0!==a.globalScope[c])return"lang.update(gscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.globalScope._SymbolsMap[c])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")";throw Error("Variable not recognised");}function ga(a,b){var c=g(a,b.right),d=null,e="";if("MemberExpression"===b.left.type)return d=g(a,b.left.object),e=!0===b.left.computed?g(a,b.left.property):"'"+b.left.property.name+"'","lang.assignmember("+
d+","+e+",'"+b.operator+"',"+c+");";if(d=b.left.name.toLowerCase(),null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+d+"']); ";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+a.localScope._SymbolsMap[d]+"']); "}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+d+"']); ";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+
a.globalScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+a.globalScope._SymbolsMap[d]+"']); ";throw Error("Variable not recognised");}function M(a,b){return"BlockStatement"===b.type?g(a,b):"ReturnStatement"===b.type?g(a,b):"BreakStatement"===b.type?g(a,b):"ContinueStatement"===b.type?g(a,b):"UpdateExpression"===b.type?"lastStatement \x3d "+g(a,b)+";":"ExpressionStatement"===b.type?g(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+g(a,b)+";":g(a,b)}function K(a,b){for(var c=
"",d=0;d<b.body.length;d++)c+="ReturnStatement"===b.body[d].type?g(a,b.body[d])+" \n":"BreakStatement"===b.body[d].type?g(a,b.body[d])+" \n":"ContinueStatement"===b.body[d].type?g(a,b.body[d])+" \n":"UpdateExpression"===b.body[d].type?"lastStatement \x3d "+g(a,b.body[d])+"; \n":"ObjectExpression"===b.body[d].type?"lastStatement \x3d "+g(a,b.body[d])+"; \n":g(a,b.body[d])+" \n";return c}function ea(a,b){var c=null===b.init?null:g(a,b.init);c===d.voidOperation&&(c=null);b=b.id.name.toLowerCase();if(null!==
a.localScope){if(void 0!==a.localScope[b])return"lscope['"+b+"']\x3d"+c+";";if(void 0!==a.localScope._SymbolsMap[b])return"lscope['"+a.localScope._SymbolsMap[b]+"']\x3d"+c+";";var f=G(b,a);return a.localScope._SymbolsMap[b]=f,"lscope['"+f+"']\x3d"+c+";"}if(void 0!==a.globalScope[b])return"gscope['"+b+"']\x3d"+c+";";if(void 0!==a.globalScope._SymbolsMap[b])return"gscope['"+a.globalScope._SymbolsMap[b]+"']\x3d"+c+";";f=G(b,a);return a.globalScope._SymbolsMap[b]=f,"gscope['"+f+"']\x3d"+c+";"}function ja(a,
b,c){switch(b=b.toLowerCase()){case "hasz":return a=a.hasZ,void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return b=a.spatialReference._arcadeCacheId,void 0===b&&(c=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(c=!1),c&&(p++,a.spatialReference._arcadeCacheId=p,b=p)),a=new t({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==b&&(a._arcadeCacheId="SPREF"+b.toString()),a}switch(a.type){case "extent":switch(b){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=
a[b],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(b){case "rings":return b=d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(p++,b=p,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new D(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polygon"}break;case "point":switch(b){case "x":case "y":case "z":case "m":return void 0!==a[b]?a[b]:null;case "type":return"Point"}break;case "polyline":switch(b){case "paths":return b=
d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(p++,b=p,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new D(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polyline"}break;case "multipoint":switch(b){case "points":return b=d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(p++,b=p,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new ca(a.points,a.spatialReference,
!0===a.hasZ,!0===a.hasM,b,1);case "type":return"Multipoint"}}throw Error(h.nodeErrorMessage(c,"RUNTIME","PROPERTYNOTFOUND"));}function ia(a,b){try{var c=b.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[c])return"lscope['"+c+"']";if(void 0!==a.localScope._SymbolsMap[c])return"lscope['"+a.localScope._SymbolsMap[c]+"']"}if(void 0!==a.globalScope[c])return"gscope['"+c+"']";if(void 0!==a.globalScope._SymbolsMap[c])return"gscope['"+a.globalScope._SymbolsMap[c]+"']";throw Error(h.nodeErrorMessage(b,
"RUNTIME","VARIABLENOTFOUND"));}catch(f){throw f;}}function F(a){return null===a?"":d.isArray(a)?"Array":d.isImmutableArray(a)?"Array":d.isDate(a)?"Date":d.isString(a)?"String":d.isBoolean(a)?"Boolean":d.isNumber(a)?"Number":a instanceof t?"Dictionary":a instanceof y?"Feature":a instanceof S?"Point":a instanceof Q?"Polygon":a instanceof R?"Polyline":a instanceof U?"Multipoint":a instanceof T?"Extent":d.isFunctionParameter(a)?"Function":a===d.voidOperation?"":"number"==typeof a&&isNaN(a)?"Number":
"Unrecognised Type"}function I(a,b,c,f){try{if(d.equalityTest(b[c],f))return b[c+1];var e=b.length-c;return 1===e?b[c]:2===e?null:3===e?b[c+2]:I(a,b,c+2,f)}catch(u){throw u;}}function J(a,b,c,f){try{if(!0===f)return b[c+1];if(3===b.length-c)return b[c+2];var e=b[c+2];if(!1===d.isBoolean(e))throw Error("WHEN needs boolean test conditions");return J(a,b,c+2,e)}catch(u){throw u;}}function n(a,b){var c=a.length,d=Math.floor(c/2);if(0===c)b=[];else if(1===c)b=[a[0]];else{var e=n(a.slice(0,d),b);a=n(a.slice(d,
c),b);for(c=[];0<e.length||0<a.length;)0<e.length&&0<a.length?(d=b(e[0],a[0]),isNaN(d)&&(d=0),0>=d?(c.push(e[0]),e=e.slice(1)):(c.push(a[0]),a=a.slice(1))):0<e.length?(c.push(e[0]),e=e.slice(1)):0<a.length&&(c.push(a[0]),a=a.slice(1));b=c}return b}function G(a,b){return b.symbols.symbolCounter++,"_T"+b.symbols.symbolCounter.toString()}function B(a){return a.symbols.symbolCounter++,"_Tvar"+a.symbols.symbolCounter.toString()}function ka(a,b,c){var d={};a||(a={});c||(c={});d._SymbolsMap={};d.textformatting=
1;d.infinity=1;d.pi=1;for(var e in b)d[e]=1;for(e in c)d[e]=1;for(e in a)d[e]=1;return d}function N(a){console.log(a)}Object.defineProperty(r,"__esModule",{value:!0});var p=0,l={};W.registerFunctions(l,m);X.registerFunctions(l,m);Y.registerFunctions(l,m);Z.registerFunctions(l,m);ba.registerFunctions(l,m);aa.registerFunctions(l,m);l["typeof"]=function(a,b){return m(a,b,function(b,a,e){d.pcCheck(e,1,1);b=F(e[0]);if("Unrecognised Type"===b)throw Error("Unrecognised Type");return b})};l.iif=function(a,
b){try{return m(a,b,function(b,a,e){if(d.pcCheck(e,3,3),!1===d.isBoolean(e[0]))throw Error("IF Function must have a boolean test condition");return e[0]?e[1]:e[2]})}catch(c){throw c;}};l.decode=function(a,b){try{return m(a,b,function(b,d,e){if(2>e.length)throw Error("Missing Parameters");if(2===e.length)return e[1];if(0===(e.length-1)%2)throw Error("Must have a default value result.");return I(a,e,1,e[0])})}catch(c){throw c;}};l.when=function(a,b){try{return m(a,b,function(b,f,e){if(3>e.length)throw Error("Missing Parameters");
if(0===e.length%2)throw Error("Must have a default value result.");b=e[0];if(!1===d.isBoolean(b))throw Error("WHEN needs boolean test conditions");return J(a,e,0,b)})}catch(c){throw c;}};l.top=function(a,b){return m(a,b,function(b,a,e){if(d.pcCheck(e,2,2),d.isArray(e[0]))return d.toNumber(e[1])>=e[0].length?e[0].slice(0):e[0].slice(0,d.toNumber(e[1]));if(d.isImmutableArray(e[0]))return d.toNumber(e[1])>=e[0].length()?e[0].slice(0):e[0].slice(0,d.toNumber(e[1]));throw Error("Top cannot accept this parameter type");
})};l.first=function(a,b){return m(a,b,function(b,a,e){return d.pcCheck(e,1,1),d.isArray(e[0])?0===e[0].length?null:e[0][0]:d.isImmutableArray(e[0])?0===e[0].length()?null:e[0].get(0):null})};l.sort=function(a,b){return m(a,b,function(b,a,e){d.pcCheck(e,1,2);a=e[0];if(d.isImmutableArray(a)&&(a=a.toArray()),!1===d.isArray(a))throw Error("Illegal Argument");if(1<e.length){if(!1===d.isFunctionParameter(e[1]))throw Error("Illegal Argument");return a=n(a,function(a,c){return O.callfunc(e[1],[a,c],b)})}if(0===
a.length)return[];for(var c={},f=0;f<a.length;f++){var g=F(a[f]);""!==g&&(c[g]=!0)}if(!0===c.Array||!0===c.Dictionary||!0===c.Feature||!0===c.Point||!0===c.Polygon||!0===c.Polyline||!0===c.Multipoint||!0===c.Extent||!0===c.Function)return a.slice(0);var f=0,g="",h;for(h in c)f++,g=h;return a=1<f||"String"===g?n(a,function(a,b){if(null===a||void 0===a||a===d.voidOperation)return null===b||void 0===b||b===d.voidOperation?0:1;if(null===b||void 0===b||b===d.voidOperation)return-1;a=d.toString(a);b=d.toString(b);
return b>a?-1:a===b?0:1}):"Number"===g?n(a,function(a,b){return a-b}):"Boolean"===g?n(a,function(a,b){return a===b?0:b?-1:1}):"Date"===g?n(a,function(a,b){return b-a}):a.slice(0)})};for(var P in l)l[P]=new d.NativeFunction(l[P]);var C=function(){};C.prototype=l;r.functionHelper={fixSpatialReference:d.fixSpatialReference,parseArguments:function(a,b){for(var c=[],d=0;d<b.arguments.length;d++)c.push(g(a,b.arguments[d]));return c},standardFunction:m};r.extend=function(a){for(var b={mode:"sync",compiled:!0,
functions:{},signatures:[],standardFunction:m},c=0;c<a.length;c++)a[c].registerFunctions(b);for(var f in b.functions)l[f]=new d.NativeFunction(b.functions[f]),C.prototype[f]=l[f];for(c=0;c<b.signatures.length;c++)h.addFunctionDeclaration(b.signatures[c],"f")};r.executeScript=function(a,b,c){return a(b,c)};r.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),h.findFieldLiterals(a,b)};r.validateScript=function(a,b){return h.validateScript(a,b,"simple")};r.referencesMember=function(a,b){return h.referencesMember(a,
b)};r.referencesFunction=function(a,b){return h.referencesFunction(a,b)};var O={error:function(a,b,c){throw Error(h.nodeErrorMessage(a,b,c));},functionDepthchecker:function(a,b){return function(){if(b.depthCounte++,64<b.depthCounter)throw Error("Exceeded maximum function depth");var c=a.apply(this,arguments);return b.depthCounte--,c}},aCheck:function(a,b){if(d.isFunctionParameter(a))throw Error(h.nodeErrorMessage({type:b},"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return a===d.voidOperation?null:a},Dictionary:t,
Feature:y,dictionary:function(a){for(var b={},c=0;c<a.length;c+=2){if(d.isFunctionParameter(a[c+1]))throw Error("Illegal Argument");if(!1===d.isString(a[c]))throw Error("Illegal Argument");a[c+1]===d.voidOperation?b[a[c].toString()]=null:b[a[c].toString()]=a[c+1]}a=new t(b);return a.immutable=!1,a},strCheck:function(a,b){if(!1===d.isString(a))throw Error("Illegal Argument");return a},unary:function(a,b){if(d.isBoolean(a)){if("!"===b)return!a;if("-"===b)return-1*d.toNumber(a);if("+"===b)return 1*d.toNumber(a);
throw Error(h.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b)return-1*d.toNumber(a);if("+"===b)return 1*d.toNumber(a);throw Error(h.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logicalCheck:function(a){if(!1===d.isBoolean(a))throw Error(h.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));return a},logical:function(a,b,c){if(!d.isBoolean(a)||!d.isBoolean(b))throw Error(h.nodeErrorMessage("LogicalExpression",
"RUNTIME","ONLYORORAND"));switch(c){case "||":return a||b;case "\x26\x26":return a&&b;default:throw Error(h.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}},binary:function(a,b,c){switch(c){case "\x3d\x3d":return d.equalityTest(a,b);case "\x3d":return d.equalityTest(a,b);case "!\x3d":return!d.equalityTest(a,b);case "\x3c":return d.greaterThanLessThan(a,b,c);case "\x3e":return d.greaterThanLessThan(a,b,c);case "\x3c\x3d":return d.greaterThanLessThan(a,b,c);case "\x3e\x3d":return d.greaterThanLessThan(a,
b,c);case "+":return d.isString(a)||d.isString(b)?d.toString(a)+d.toString(b):d.toNumber(a)+d.toNumber(b);case "-":return d.toNumber(a)-d.toNumber(b);case "*":return d.toNumber(a)*d.toNumber(b);case "/":return d.toNumber(a)/d.toNumber(b);case "%":return d.toNumber(a)%d.toNumber(b);default:throw Error(h.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(a,b,c){switch(b){case "\x3d":return a===d.voidOperation?null:a;case "/\x3d":return d.toNumber(c)/d.toNumber(a);
case "*\x3d":return d.toNumber(c)*d.toNumber(a);case "-\x3d":return d.toNumber(c)-d.toNumber(a);case "+\x3d":return d.isString(c)||d.isString(a)?d.toString(c)+d.toString(a):d.toNumber(c)+d.toNumber(a);case "%\x3d":return d.toNumber(c)%d.toNumber(a);default:throw Error(h.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(a,b,c,f){var e=d.toNumber(a[b]);return a[b]="++"===c?e+1:e-1,!1===f?e:"++"===c?e+1:e-1},memberupdate:function(a,b,c,f){var e;if(d.isArray(a)){if(!d.isNumber(b))throw Error("Invalid Parameter");
if(0>b&&(b=a.length+b),0>b||b>=a.length)throw Error("Assignment outside of array bounds");e=d.toNumber(a[b]);a[b]="++"===c?e+1:e-1}else{if(a instanceof t){if(!1===d.isString(b))throw Error("Dictionary accessor must be a string");}else{if(!(a instanceof y))throw d.isImmutableArray(a)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===d.isString(b))throw Error("Feature accessor must be a string");}if(!0!==a.hasField(b))throw Error("Invalid Parameter");e=d.toNumber(a.field(b));a.setField(b,
"++"===c?e+1:e-1)}return!1===f?e:"++"===c?e+1:e-1},assignmember:function(a,b,c,f){if(d.isArray(a)){if(!d.isNumber(b))throw Error("Invalid Parameter");if(0>b&&(b=a.length+b),0>b||b>a.length)throw Error("Assignment outside of array bounds");if(b===a.length&&"\x3d"!==c)throw Error("Invalid Parameter");a[b]=this.assign(f,c,a[b])}else{if(a instanceof t){if(!1===d.isString(b))throw Error("Dictionary accessor must be a string");}else{if(!(a instanceof y))throw d.isImmutableArray(a)?Error("Array is Immutable"):
Error("Invalid Parameter");if(!1===d.isString(b))throw Error("Feature accessor must be a string");}if(!0===a.hasField(b))a.setField(b,this.assign(f,c,a.field(b)));else{if("\x3d"!==c)throw Error("Invalid Parameter");a.setField(b,this.assign(f,c,null))}}},member:function(a,b){if(null===a)throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","NOTFOUND"));if(a instanceof t||a instanceof y){if(d.isString(b))return a.field(b);throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));
}if(a instanceof da){if(d.isString(b))return ja(a,b,"MemberExpression");throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(d.isArray(a)){if(d.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length+b),b>=a.length||0>b)throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[b]}throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(d.isString(a)){if(d.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length+
b),b>=a.length||0>b)throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[b]}throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(d.isImmutableArray(a)&&d.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length()+b),b>=a.length()||0>b)throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a.get(b)}throw Error(h.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:function(a,b,c){return a instanceof
d.NativeFunction?a.fn(c,b):a instanceof d.SizzleFunction?a.fn.apply(this,b):a.apply(this,b)}};r.compileScript=function(a,b){void 0===b&&(b=null);null===b&&(b={vars:{},customfunctions:{}});b={globalScope:ka(b.vars,l,b.customfunctions),localScope:null,console:N,symbols:{symbolCounter:0}};a=g(b,a.body[0].body);""===a&&(a="lc.voidOperation;");b={lc:d,lang:O,postProcess:function(a){if(a instanceof d.ReturnResult&&(a=a.value),a instanceof d.ImplicitResult&&(a=a.value),a===d.voidOperation&&(a=null),a===
d.breakResult)throw Error("Cannot return BREAK");if(a===d.continueResult)throw Error("Cannot return CONTINUE");if(d.isFunctionParameter(a))throw Error("Cannot return FUNCTION");return a},prepare:function(a,b){b||(b=new V({wkid:102100}));var c=a.vars,d=a.customfunctions,f=new C;c||(c={});d||(d={});var g=new t({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});g.immutable=!1;f._SymbolsMap={textformatting:1,infinity:1,pi:1};f.textformatting=g;f.infinity=Number.POSITIVE_INFINITY;
f.pi=Math.PI;for(var h in d)f[h]=d[h],f._SymbolsMap[h]=1;for(h in c)f._SymbolsMap[h]=1,c[h]&&"esri.Graphic"===c[h].declaredClass?f[h]=new y(c[h]):f[h]=c[h];return{spatialReference:b,globalScope:f,localScope:null,console:a.console?a.console:N,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===a.applicationCache?null:a.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+
a+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(b)}});