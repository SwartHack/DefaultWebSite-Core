//>>built
define(["require","dojo/aspect","dojo/_base/array","dojo/Deferred","dojo/when"],function(h,k,l,m,n){function g(){k.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}return g.prototype={addPlugin:function(b,a){var e=this,c=this._plugins,d=new m;try{h([b],function(f){b in c?d.resolve({id:c[b].declaredId||b.replace(/\//g,".")}):(c[b]=f,n(f.add(e,a),function(){var a={id:f.declaredId||b.replace(/\//g,".")};e.emit("plugin-add",a);d.resolve(a)},function(a){d.reject(a)}))})}catch(f){d.reject(f)}return d.promise},
removePlugin:function(b){if(b in this._plugins){var a=this._plugins[b];a.remove(this);delete this._plugins[b];this.emit("plugin-remove",{id:a.declaredId||b.replace(/\//g,".")})}},_pluginsHandler:function(){var b=this;l.some(arguments,function(a){if(a&&a.plugins&&a.plugins instanceof Array){var e,c,d=a.plugins;for(c=0;c<d.length;c++)a=d[c],e=a instanceof Object?a.id:a,b.addPlugin(e,a.options);return!0}})}},g});