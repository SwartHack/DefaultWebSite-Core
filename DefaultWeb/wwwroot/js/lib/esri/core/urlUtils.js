//>>built
define("require exports dojo/_base/window dojo/_base/lang dojo/_base/url dojo/io-query ../config ./lang ./sniff ./Logger ./Error".split(" "),function(C,d,V,W,h,x,D,X,E,Y,Z){function r(a){var b={path:null,query:null},c=new h(a),d=a.indexOf("?");return null===c.query?b.path=a:(b.path=a.substring(0,d),b.query=x.queryToObject(c.query)),c.fragment&&(b.hash=c.fragment,null===c.query&&(b.path=b.path.substring(0,b.path.length-(c.fragment.length+1)))),b}function F(a,b){void 0===a&&(a=!1);void 0===b&&(b=!0);
var c,g=p.proxyUrl;"string"==typeof a?(c=G(a),(a=y(a))&&(g=a.proxyUrl)):c=!!a;if(!g)throw aa.warn(H),new Z("urlutils:proxy-not-set",H);var e;c&&b&&"https"===d.appUrl.scheme&&(b=z(g),t(b)&&(g=b,e=1));g=r(g);return g._xo=e,g}function I(a){var b=a.indexOf("?");return-1!==b?(q.path=a.slice(0,b),q.query=a.slice(b+1)):(q.path=a,q.query=null),q}function J(a){return a=I(a).path,a=a&&"/"===a[a.length-1]?a:a+"/",a=A(a,!0),a=a.toLowerCase()}function y(a){var b=p.proxyRules;a=J(a);for(var c=0;c<b.length;c++)if(0===
a.indexOf(b[c].urlPrefix))return b[c]}function K(a){a=l(a);var b=a.indexOf("/sharing");return 0<b?a.substring(0,b):a.replace(/\/+$/,"")}function u(a,b,c){void 0===c&&(c=!1);a=B(a);b=B(b);return c||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port:!1}function t(a){return E("esri-phonegap")?!0:E("esri-cors")?null!=L(a):!1}function L(a,b){void 0===b&&(b=!1);"string"==typeof a&&(a=k(a)?B(a):d.appUrl);for(var c=p.corsEnabledServers||[],g=0;g<c.length;g++)for(var e=c[g],m=
void 0,m="string"==typeof e?M(e):e.host?M(e.host):[],f=0;f<m.length;f++)if(u(a,m[f]))return b?g:e;return b?-1:null}function M(a){return d.corsServersUrlCache[a]||(v(a)||f(a)?d.corsServersUrlCache[a]=[new h(n(a))]:d.corsServersUrlCache[a]=[new h("http://"+a),new h("https://"+a)]),d.corsServersUrlCache[a]}function n(a,b,c){void 0===b&&(b=d.appBaseUrl);if(f(a))a=c&&c.preserveProtocolRelative?a:"http"===d.appUrl.scheme&&d.appUrl.authority===N(a).slice(2)?"http:"+a:"https:"+a;else if(!v(a)){c=O;if("/"===
a[0]){var g=b.indexOf("//"),g=b.indexOf("/",g+2);b=-1===g?b:b.slice(0,g)}a=c(b,a)}return a}function P(a,b,c){if(void 0===b&&(b=d.appBaseUrl),!k(a))return a;var g=l(a),e=g.toLowerCase();b=l(b).toLowerCase().replace(/\/+$/,"");if((c=c?l(c).toLowerCase().replace(/\/+$/,""):null)&&0!==b.indexOf(c))return a;for(var m=function(a,b,c){return c=a.indexOf(b,c),-1===c?a.length:c},f=m(e,"/",e.indexOf("//")+2),h=-1;e.slice(0,f+1)===b.slice(0,f)+"/"&&(h=f+1,f!==e.length);)f=m(e,"/",f+1);if(-1===h||c&&h<c.length)return a;
a=g.slice(h);g=b.slice(h-1).replace(/[^\/]+/g,"").length;if(0<g)for(e=0;g>e;e++)a="../"+a;else a="./"+a;return a}function l(a){a=a.trim();var b=a=n(a);return a="http"===d.appUrl.scheme&&G(b)&&u(d.appBaseUrl,b,!0)&&!t(b)?f(b)?"http:"+b:b.replace(Q,"http:"):b,a=ba(a),a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function O(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a&&a.length){b=[];if(k(a[0])){var c=a[0],d=c.indexOf("//");b.push(c.slice(0,d+1));ca.test(a[0])&&(b[0]+="/");
a[0]=c.slice(d+2)}else"/"===a[0][0]&&b.push("");a=a.reduce(function(a,b){return b?a.concat(b.split("/")):a},[]);for(c=0;c<a.length;c++)d=a[c],".."===d&&0<b.length?b.pop():!d||"."===d&&0!==b.length||b.push(d);return b.join("/")}}function N(a){if(R(a)||S(a))return null;var b=a.indexOf("://");if(-1===b&&f(a))b=2;else{if(-1===b)return null;b+=3}b=a.indexOf("/",b);return-1===b?a:a.slice(0,b)}function k(a){return f(a)||v(a)}function R(a){return"blob:"===a.slice(0,5)}function S(a){return"data:"===a.slice(0,
5)}function f(a){return a&&"/"===a[0]&&"/"===a[1]}function v(a){return T.test(a)}function G(a){return Q.test(a)||"https"===d.appUrl.scheme&&f(a)}function da(a){return U.test(a)||"http"===d.appUrl.scheme&&f(a)}function z(a){return f(a)?"https:"+a:a.replace(U,"https:")}function A(a,b){return void 0===b&&(b=!1),f(a)?a.slice(2):(a=a.replace(T,""),b&&1<a.length&&"/"===a[0]&&"/"===a[1]&&(a=a.slice(2)),a)}function ba(a){var b=D.request.httpsDomains;if(!da(a))return a;var c,g=a.indexOf("/",7);return c=-1===
g?a:a.slice(0,g),c=c.toLowerCase().slice(7),"http"!==d.appUrl.scheme||c!==d.appUrl.authority||ea.test(a)&&t(a)?(("https"===d.appUrl.scheme&&c===d.appUrl.authority||b&&b.some(function(a){return c===a||X.endsWith(c,"."+a)}))&&(a=z(a)),a):a}function w(a,b,c){if(!(b&&c&&a&&k(a)))return a;var d=a.indexOf("//"),e=a.indexOf("/",d+2),f=a.indexOf(":",d+2),e=Math.min(0>e?a.length:e,0>f?a.length:f);if(a.slice(d+2,e).toLowerCase()!==b.toLowerCase())return a;b=a.slice(0,d+2);a=a.slice(e);return""+b+c+a}function B(a){return"string"==
typeof a?new h(n(a)):(a.scheme||(a.scheme=d.appUrl.scheme),a)}Object.defineProperty(d,"__esModule",{value:!0});C=V.global;var aa=Y.getLogger("esri.core.urlUtils"),p=D.request,H="esri/config: esriConfig.request.proxyUrl is not set. If making a request to a CORS-enabled\n server, please push the domain into esriConfig.request.corsEnabledServers.",T=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,U=/^\s*http:/i,Q=/^\s*https:/i,ca=/^\s*file:/i,ea=/^https?:\/\/[^\/]+\.arcgis.com\/sharing(\/|$)/i;d.appUrl=new h(C.location);
d.corsServersUrlCache={};d.appBaseUrl=function(){var a=d.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(d.appUrl.scheme+"://"+d.appUrl.host+(null!=d.appUrl.port?":"+d.appUrl.port:""))+a}();d.urlToObject=r;d.getProxyUrl=F;d.addProxy=function(a){var b,c,d=y(a);d?(c=I(d.proxyUrl),b=c.path,c=c.query?x.queryToObject(c.query):null):p.forceProxy&&(c=F(),b=c.path,c=c.query);b&&(d=r(a),a=b+"?"+d.path,(b=x.objectToQuery(W.mixin(c||{},d.query)))&&(a=a+"?"+b));return a};
var q={path:"",query:""};d.addProxyRule=function(a){a={proxyUrl:a.proxyUrl,urlPrefix:J(a.urlPrefix)};for(var b=p.proxyRules,c=a.urlPrefix,d=b.length,e=0;e<b.length;e++){var f=b[e].urlPrefix;if(0===c.indexOf(f)){if(c.length===f.length)return-1;d=e;break}0===f.indexOf(c)&&(d=e+1)}return b.splice(d,0,a),d};d.getProxyRule=y;d.hasSamePortal=function(a,b){return a=K(a),b=K(b),A(a)===A(b)};d.hasSameOrigin=u;d.canUseXhr=t;d.getCorsConfig=L;d.makeAbsolute=n;d.makeRelative=P;d.normalize=l;d.join=O;d.getOrigin=
N;d.isAbsolute=k;d.isBlobProtocol=R;d.isDataProtocol=S;var fa=/^data:(.*?)(;base64)?,(.*)$/;d.dataComponents=function(a){return(a=a.match(fa))?{mediaType:a[1],isBase64:!!a[2],data:a[3]}:null};d.makeData=function(a){return a.isBase64?"data:"+a.mediaType+";base64,"+a.data:"data:"+a.mediaType+","+a.data};d.isProtocolRelative=f;d.hasProtocol=v;d.toHTTPS=z;d.removeFile=function(a){var b=0;if(k(a)){var c=a.indexOf("//");-1!==c&&(b=c+2)}c=a.lastIndexOf("/");return b>c?a:a.slice(0,c+1)};d.removeTrailingSlash=
function(a){return a.replace(/\/+$/,"")};d.changeDomain=w;d.read=function(a,b){var c=b&&b.url&&b.url.path;a&&c&&(a=n(a,c,{preserveProtocolRelative:!0}));(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?(c=b.urlKey+"."+b.customBaseUrl,b=u(d.appUrl,d.appUrl.scheme+"://"+c)?w(a,b.portalHostname,c):w(a,c,b.portalHostname)):b=a;return b};d.write=function(a,b){if(!a)return a;!k(a)&&b&&b.blockedRelativeUrls&&b.blockedRelativeUrls.push(a);var c=n(a);if(b){var d=b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.rootPath||
b.url&&b.url.path;d&&(c=P(c,d,d),c!==a&&b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.writtenUrls.push(c))}a=c;return c=(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?w(a,b.urlKey+"."+b.customBaseUrl,b.portalHostname):a};d.writeOperationalLayerUrl=function(a,b){a&&f(a)&&(a="https:"+a);b.url=a?l(a):a};d.isSVG=function(a){return ga.test(a)};d.removeQueryParameters=function(a,b){a=r(a);var c=Object.keys(a.query||{});return 0<c.length&&b&&b.warn("removeQueryParameters()","Url query parameters are not supported, the following parameters have been removed: "+
c.join(", ")+"."),a.path};var ga=/(^data:image\/svg|\.svg$)/i});