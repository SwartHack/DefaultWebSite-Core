//>>built
define(["dojo/_base/array"],function(f){return{_serializeLayerDefinitions:function(b){var a=[],d=!1,e=/[:;]/;if(b&&(f.forEach(b,function(b,c){b&&(a.push([c,b]),!d&&e.test(b)&&(d=!0))}),0<a.length)){var c;return d?(c={},f.forEach(a,function(a){c[a[0]]=a[1]}),c=JSON.stringify(c)):(c=[],f.forEach(a,function(a){c.push(a[0]+":"+a[1])}),c=c.join(";")),c}return null},_serializeTimeOptions:function(b,a){if(b){var d=[];return f.forEach(b,function(b,c){b&&(b=b.toJSON(),a&&-1!==f.indexOf(a,c)&&(b.useTime=!1),
d.push('"'+c+'":'+JSON.stringify(b)))}),d.length?"{"+d.join(",")+"}":void 0}},_getVisibleLayers:function(b,a){var d,e,c=[];if(!b)return c;if(a)for(c=a.concat(),e=0;e<b.length;e++)a=b[e],d=f.indexOf(b,a.id),a.subLayerIds&&-1<d&&(c.splice(d,1),c=c.concat(a.subLayerIds));else c=this._getDefaultVisibleLayers(b);return c},_getDefaultVisibleLayers:function(b){var a,d=[];if(!b)return d;for(a=0;a<b.length;a++)0<=b[a].parentLayerId&&-1===f.indexOf(d,b[a].parentLayerId)&&f.some(b,function(d){return d.id===
b[a].parentLayerId})||b[a].defaultVisibility&&d.push(b[a].id);return d},_getLayersForScale:function(b,a){var d=[];if(0<b&&a){var e;for(e=0;e<a.length;e++)if(!(0<=a[e].parentLayerId&&-1===f.indexOf(d,a[e].parentLayerId)&&f.some(a,function(b){return b.id===a[e].parentLayerId}))&&0<=a[e].id){var c=!0,g=a[e].maxScale,h=a[e].minScale;(0<g||0<h)&&(0<g&&0<h?c=b>=g&&h>=b:0<g?c=b>=g:0<h&&(c=h>=b));c&&d.push(a[e].id)}}return d}}});