//>>built
define([],function(){return function(){function R(){}function S(a,e){for(var d,h,b=0,u=[],c=16;0<c&&!a[c-1];)c--;u.push({children:[],index:0});var g,l=u[0];for(d=0;c>d;d++){for(h=0;h<a[d];h++){l=u.pop();for(l.children[l.index]=e[b];0<l.index;)l=u.pop();l.index++;for(u.push(l);u.length<=d;)u.push(g={children:[],index:0}),l.children[l.index]=g.children,l=g;b++}c>d+1&&(u.push(g={children:[],index:0}),l.children[l.index]=g.children,l=g)}return u[0].children}function T(a,e,d,h,b,u,c,g,l){function q(){if(0<
p)return p--,y>>p&1;if(y=a[e++],255===y){var c=a[e++];if(c)throw"unexpected marker: "+(y<<8|c).toString(16);}return p=7,y>>>7}function w(a){for(;;){if(a=a[q()],"number"==typeof a)return a;if("object"!=typeof a)throw"invalid huffman sequence";}}function z(a){for(var c=0;0<a;)c=c<<1|q(),a--;return c}function k(a){if(1===a)return 1===q()?1:-1;var c=z(a);return c>=1<<a-1?c:c+(-1<<a)+1}function f(a,c){var b=w(a.huffmanTableDC),b=0===b?0:k(b);a.blockData[c]=a.pred+=b;for(b=1;64>b;){var d=w(a.huffmanTableAC),
e=15&d,d=d>>4;if(0!==e)b+=d,a.blockData[c+N[b]]=k(e),b++;else{if(15>d)break;b+=16}}}function r(a,c){var b=w(a.huffmanTableDC),b=0===b?0:k(b)<<l;a.blockData[c]=a.pred+=b}function x(a,c){a.blockData[c]|=q()<<l}function v(a,b){if(0<G)return void G--;for(var d=u;c>=d;){var e=w(a.huffmanTableAC),f=15&e,e=e>>4;if(0!==f)d+=e,a.blockData[b+N[d]]=k(f)*(1<<l),d++;else{if(15>e){G=z(e)+(1<<e)-1;break}d+=16}}}function A(a,b){for(var d,e,f=u,g=0;c>=f;){var h=N[f];switch(I){case 0:if(e=w(a.huffmanTableAC),d=15&
e,g=e>>4,0===d)15>g?(G=z(g)+(1<<g),I=4):(g=16,I=1);else{if(1!==d)throw"invalid ACn encoding";B=k(d);I=g?2:3}continue;case 1:case 2:a.blockData[b+h]?a.blockData[b+h]+=q()<<l:(g--,0===g&&(I=2===I?3:0));break;case 3:a.blockData[b+h]?a.blockData[b+h]+=q()<<l:(a.blockData[b+h]=B<<l,I=0);break;case 4:a.blockData[b+h]&&(a.blockData[b+h]+=q()<<l)}f++}4===I&&(G--,0===G&&(I=0))}var B,n,E,F,C,D=(d.precision,d.samplesPerLine,d.scanLines,d.mcusPerLine),m=d.progressive,t=(d.maxH,d.maxV,e),y=0,p=0,G=0,I=0,H=h.length;
g=m?0===u?0===g?r:x:0===g?v:A:f;var J,K,m=0;K=1===H?h[0].blocksPerLine*h[0].blocksPerColumn:D*d.mcusPerColumn;b||(b=K);for(var L,M;K>m;){for(n=0;H>n;n++)h[n].pred=0;if(G=0,1===H)for(d=h[0],C=0;b>C;C++)g(d,64*((d.blocksPerLine+1)*(m/d.blocksPerLine|0)+m%d.blocksPerLine)),m++;else for(C=0;b>C;C++){for(n=0;H>n;n++)for(d=h[n],L=d.h,M=d.v,E=0;M>E;E++)for(F=0;L>F;F++)g(d,64*((d.blocksPerLine+1)*((m/D|0)*d.v+E)+(m%D*d.h+F)));m++}if(p=0,J=a[e]<<8|a[e+1],65280>=J)throw"marker was not found";if(!(65488<=J&&
65495>=J))break;e+=2}return e-t}function U(a,e){a=e.blocksPerLine;for(var d=e.blocksPerColumn,h=new Int16Array(64),b=0;d>b;b++)for(var u=0;a>u;u++){for(var c=64*((e.blocksPerLine+1)*b+u),g=h,l=void 0,q=void 0,w=void 0,z=void 0,k=void 0,f=void 0,r=void 0,x=void 0,v=void 0,A=void 0,B=void 0,n=void 0,E=void 0,F=void 0,C=void 0,D=void 0,m=void 0,t=e.quantizationTable,y=e.blockData,p=0;64>p;p+=8)v=y[c+p],A=y[c+p+1],B=y[c+p+2],n=y[c+p+3],E=y[c+p+4],F=y[c+p+5],C=y[c+p+6],D=y[c+p+7],v*=t[p],0!==(A|B|n|E|
F|C|D)?(A*=t[p+1],B*=t[p+2],n*=t[p+3],E*=t[p+4],F*=t[p+5],C*=t[p+6],D*=t[p+7],l=H*v+128>>8,q=H*E+128>>8,w=B,z=C,k=J*(A-D)+128>>8,x=J*(A+D)+128>>8,f=n<<4,r=F<<4,l=l+q+1>>1,q=l-q,m=w*K+z*L+128>>8,w=w*L-z*K+128>>8,z=m,k=k+r+1>>1,r=k-r,x=x+f+1>>1,f=x-f,l=l+z+1>>1,z=l-z,q=q+w+1>>1,w=q-w,m=k*M+x*O+2048>>12,k=k*O-x*M+2048>>12,x=m,m=f*P+r*Q+2048>>12,f=f*Q-r*P+2048>>12,r=m,g[p]=l+x,g[p+7]=l-x,g[p+1]=q+r,g[p+6]=q-r,g[p+2]=w+f,g[p+5]=w-f,g[p+3]=z+k,g[p+4]=z-k):(m=H*v+512>>10,g[p]=m,g[p+1]=m,g[p+2]=m,g[p+3]=
m,g[p+4]=m,g[p+5]=m,g[p+6]=m,g[p+7]=m);for(t=0;8>t;++t)v=g[t],A=g[t+8],B=g[t+16],n=g[t+24],E=g[t+32],F=g[t+40],C=g[t+48],D=g[t+56],0!==(A|B|n|E|F|C|D)?(l=H*v+2048>>12,q=H*E+2048>>12,w=B,z=C,k=J*(A-D)+2048>>12,x=J*(A+D)+2048>>12,f=n,r=F,l=(l+q+1>>1)+4112,q=l-q,m=w*K+z*L+2048>>12,w=w*L-z*K+2048>>12,z=m,k=k+r+1>>1,r=k-r,x=x+f+1>>1,f=x-f,l=l+z+1>>1,z=l-z,q=q+w+1>>1,w=q-w,m=k*M+x*O+2048>>12,k=k*O-x*M+2048>>12,x=m,m=f*P+r*Q+2048>>12,f=f*Q-r*P+2048>>12,r=m,v=l+x,D=l-x,A=q+r,C=q-r,B=w+f,F=w-f,n=z+k,E=z-k,
v=16>v?0:4080<=v?255:v>>4,A=16>A?0:4080<=A?255:A>>4,B=16>B?0:4080<=B?255:B>>4,n=16>n?0:4080<=n?255:n>>4,E=16>E?0:4080<=E?255:E>>4,F=16>F?0:4080<=F?255:F>>4,C=16>C?0:4080<=C?255:C>>4,D=16>D?0:4080<=D?255:D>>4,y[c+t]=v,y[c+t+8]=A,y[c+t+16]=B,y[c+t+24]=n,y[c+t+32]=E,y[c+t+40]=F,y[c+t+48]=C,y[c+t+56]=D):(m=H*v+8192>>14,m=-2040>m?0:2024<=m?255:m+2056>>4,y[c+t]=m,y[c+t+8]=m,y[c+t+16]=m,y[c+t+24]=m,y[c+t+32]=m,y[c+t+40]=m,y[c+t+48]=m,y[c+t+56]=m)}return e.blockData}function G(a){return 0>=a?0:255<=a?255:
a}var N=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),Q=4017,P=799,O=3406,M=2276,L=1567,K=3784,H=5793,J=2896;return R.prototype={parse:function(a){function e(){var b=a[c]<<8|a[c+1];return c+=2,b}function d(){var b=e(),b=a.subarray(c,c+b-2);return c+=b.length,b}function h(a){for(var b=Math.ceil(a.samplesPerLine/8/a.maxH),c=Math.ceil(a.scanLines/8/
a.maxV),d=0;d<a.components.length;d++){n=a.components[d];var e=Math.ceil(Math.ceil(a.samplesPerLine/8)*n.h/a.maxH),f=Math.ceil(Math.ceil(a.scanLines/8)*n.v/a.maxV);n.blockData=new Int16Array(64*c*n.v*(b*n.h+1));n.blocksPerLine=e;n.blocksPerColumn=f}a.mcusPerLine=b;a.mcusPerColumn=c}var b,u,c=0,g=(a.length,null),l=null,q=[],w=[],z=[],k=e();if(65496!==k)throw"SOI not found";for(k=e();65497!==k;){var f,r;switch(k){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:f=
d();65504===k&&74===f[0]&&70===f[1]&&73===f[2]&&70===f[3]&&0===f[4]&&(g={version:{major:f[5],minor:f[6]},densityUnits:f[7],xDensity:f[8]<<8|f[9],yDensity:f[10]<<8|f[11],thumbWidth:f[12],thumbHeight:f[13],thumbData:f.subarray(14,14+3*f[12]*f[13])});65518===k&&65===f[0]&&100===f[1]&&111===f[2]&&98===f[3]&&101===f[4]&&(l={version:f[5]<<8|f[6],flags0:f[7]<<8|f[8],flags1:f[9]<<8|f[10],transformCode:f[11]});break;case 65499:for(var x=e()+c-2;x>c;){var v=a[c++],A=new Uint16Array(64);if(0===v>>4)for(f=0;64>
f;f++)k=N[f],A[k]=a[c++];else{if(1!==v>>4)throw"DQT: invalid table spec";for(f=0;64>f;f++)k=N[f],A[k]=e()}q[15&v]=A}break;case 65472:case 65473:case 65474:if(b)throw"Only single frame JPEGs supported";e();b={};b.extended=65473===k;b.progressive=65474===k;b.precision=a[c++];b.scanLines=e();b.samplesPerLine=e();b.components=[];b.componentIds={};x=a[c++];for(k=A=v=0;x>k;k++){f=a[c];r=a[c+1]>>4;var B=15&a[c+1];r>v&&(v=r);B>A&&(A=B);r=b.components.push({h:r,v:B,quantizationTable:q[a[c+2]]});b.componentIds[f]=
r-1;c+=3}b.maxH=v;b.maxV=A;h(b);break;case 65476:x=e();for(k=2;x>k;){v=a[c++];A=new Uint8Array(16);for(f=r=0;16>f;f++,c++)r+=A[f]=a[c];B=new Uint8Array(r);for(f=0;r>f;f++,c++)B[f]=a[c];k+=17+r;(0===v>>4?z:w)[15&v]=S(A,B)}break;case 65501:e();u=e();break;case 65498:var n,x=(e(),a[c++]);f=[];for(k=0;x>k;k++)v=b.componentIds[a[c++]],n=b.components[v],v=a[c++],n.huffmanTableDC=z[v>>4],n.huffmanTableAC=w[15&v],f.push(n);k=a[c++];x=a[c++];v=a[c++];k=T(a,c,b,f,u,k,x,v>>4,15&v);c+=k;break;case 65535:255!==
a[c]&&c--;break;default:if(255===a[c-3]&&192<=a[c-2]&&254>=a[c-2])c-=3;else throw"unknown JPEG marker "+k.toString(16);}k=e()}this.width=b.samplesPerLine;this.height=b.scanLines;this.jfif=g;this.eof=c;this.adobe=l;this.components=[];for(k=0;k<b.components.length;k++)n=b.components[k],this.components.push({output:U(b,n),scaleX:n.h/b.maxH,scaleY:n.v/b.maxV,blocksPerLine:n.blocksPerLine,blocksPerColumn:n.blocksPerColumn});this.numComponents=this.components.length},_getLinearizedBlockData:function(a,
e){var d,h,b,u,c,g,l,q=this.width/a,w=this.height/e,z=0,k=this.components.length,f=a*e*k,r=new Uint8Array(f),x=new Uint32Array(a);for(g=0;k>g;g++){d=this.components[g];h=d.scaleX*q;b=d.scaleY*w;z=g;l=d.output;u=d.blocksPerLine+1<<3;for(c=0;a>c;c++)d=0|c*h,x[c]=(d&4294967288)<<3|7&d;for(h=0;e>h;h++)for(d=0|h*b,d=u*(d&4294967288)|(7&d)<<3,c=0;a>c;c++)r[z]=l[d+x[c]],z+=k}if(e=this.decodeTransform)for(g=0;f>g;)for(a=d=0;k>d;d++,g++,a+=2)r[g]=(r[g]*e[a]>>8)+e[a+1];return r},_isColorConversionNeeded:function(){return this.adobe&&
this.adobe.transformCode?!0:3===this.numComponents?!0:!1},_convertYccToRgb:function(a){for(var e,d,h,b=0,u=a.length;u>b;b+=3)e=a[b],d=a[b+1],h=a[b+2],a[b]=G(e-179.456+1.402*h),a[b+1]=G(e+135.459-.344*d-.714*h),a[b+2]=G(e-226.816+1.772*d);return a},_convertYcckToRgb:function(a){for(var e,d,h,b,u=0,c=0,g=a.length;g>c;c+=4){e=a[c];d=a[c+1];h=a[c+2];b=a[c+3];var l=-122.67195406894+d*(-6.60635669420364E-5*d+4.37130475926232E-4*h-5.4080610064599E-5*e+4.8449797120281E-4*b-.154362151871126)+h*(-9.57964378445773E-4*
h+8.17076911346625E-4*e-.00477271405408747*b+1.53380253221734)+e*(9.61250184130688E-4*e-.00266257332283933*b+.48357088451265)+b*(-3.36197177618394E-4*b+.484791561490776),q=107.268039397724+d*(2.19927104525741E-5*d-6.40992018297945E-4*h+6.59397001245577E-4*e+4.26105652938837E-4*b-.176491792462875)+h*(-7.78269941513683E-4*h+.00130872261408275*e+7.70482631801132E-4*b-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*b+.25802910206845)+b*(-3.18913117588328E-4*b-.213742400323665);e=-20.810012546947+
d*(-5.70115196973677E-4*d-2.63409051004589E-5*h+.0020741088115012*e-.00288260236853442*b+.814272968359295)+h*(-1.53496057440975E-5*h-1.32689043961446E-4*e+5.60833691242812E-4*b-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*b+.116935020465145)+b*(-3.43531996510555E-4*b+.24165260232407);a[u++]=G(l);a[u++]=G(q);a[u++]=G(e)}return a},_convertYcckToCmyk:function(a){for(var e,d,h,b=0,u=a.length;u>b;b+=4)e=a[b],d=a[b+1],h=a[b+2],a[b]=G(434.456-e-1.402*h),a[b+1]=G(119.541-e+.344*d+.714*h),
a[b+2]=G(481.816-e-1.772*d);return a},_convertCmykToRgb:function(a){for(var e,d,h,b,u=0,c=1/255/255,g=0,l=a.length;l>g;g+=4){e=a[g];d=a[g+1];h=a[g+2];b=a[g+3];var q=e*(-4.387332384609988*e+54.48615194189176*d+18.82290502165302*h+212.25662451639585*b-72734.4411664936)+d*(1.7149763477362134*d-5.6096736904047315*h-17.873870861415444*b-1401.7366389350734)+h*(-2.5217340131683033*h-21.248923337353073*b+4465.541406466231)-b*(21.86122147463605*b+48317.86113160301),w=e*(8.841041422036149*e+60.118027045597366*
d+6.871425592049007*h+31.159100130055922*b-20220.756542821975)+d*(-15.310361306967817*d+17.575251261109482*h+131.35250912493976*b-48691.05921601825)+h*(4.444339102852739*h+9.8632861493405*b-6341.191035517494)-b*(20.737325471181034*b+47890.15695978492);e=e*(.8842522430003296*e+8.078677503112928*d+30.89978309703729*h-.23883238689178934*b-3616.812083916688)+d*(10.49593273432072*d+63.02378494754052*h+50.606957656360734*b-28620.90484698408)+h*(.03296041114873217*h+115.60384449646641*b-49363.43385999684)-
b*(22.33816807309886*b+45932.16563550634);a[u++]=0<=q?255:-16581375>=q?0:255+q*c|0;a[u++]=0<=w?255:-16581375>=w?0:255+w*c|0;a[u++]=0<=e?255:-16581375>=e?0:255+e*c|0}return a},getData:function(a,e,d){if(4<this.numComponents)throw"Unsupported color mode";a=this._getLinearizedBlockData(a,e);if(3===this.numComponents)return this._convertYccToRgb(a);if(4===this.numComponents){if(this._isColorConversionNeeded())return d?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(d)return this._convertCmykToRgb(a)}return a}},
R}()});