//>>built
define([],function(){var J={defaultNoDataValue:-3.4027999387901484E38,decode:function(a,m){var x;m=m||{};var g=m.inputOffset||0,h=m.encodedMaskData||null===m.encodedMaskData,b={},c=new Uint8Array(a,g,10);if(b.fileIdentifierString=String.fromCharCode.apply(null,c),"CntZImage"!=b.fileIdentifierString.trim())throw"Unexpected file identifier string: "+b.fileIdentifierString;g+=10;c=new DataView(a,g,24);if(b.fileVersion=c.getInt32(0,!0),b.imageType=c.getInt32(4,!0),b.height=c.getUint32(8,!0),b.width=c.getUint32(12,
!0),b.maxZError=c.getFloat64(16,!0),g+=24,!h)if(c=new DataView(a,g,16),b.mask={},b.mask.numBlocksY=c.getUint32(0,!0),b.mask.numBlocksX=c.getUint32(4,!0),b.mask.numBytes=c.getUint32(8,!0),b.mask.maxValue=c.getFloat32(12,!0),g+=16,0<b.mask.numBytes){var h=new Uint8Array(Math.ceil(b.width*b.height/8)),c=new DataView(a,g,b.mask.numBytes),n=c.getInt16(0,!0),k=2,z=0;do{if(0<n)for(;n--;)h[z++]=c.getUint8(k++);else for(var A=c.getUint8(k++),n=-n;n--;)h[z++]=A;n=c.getInt16(k,!0);k+=2}while(k<b.mask.numBytes);
if(-32768!==n||z<h.length)throw"Unexpected end of mask RLE encoding";b.mask.bitset=h;g+=b.mask.numBytes}else 0===(b.mask.numBytes|b.mask.numBlocksY|b.mask.maxValue)&&(h=new Uint8Array(Math.ceil(b.width*b.height/8)),b.mask.bitset=h);c=new DataView(a,g,16);b.pixels={};b.pixels.numBlocksY=c.getUint32(0,!0);b.pixels.numBlocksX=c.getUint32(4,!0);b.pixels.numBytes=c.getUint32(8,!0);b.pixels.maxValue=c.getFloat32(12,!0);g+=16;h=b.pixels.numBlocksX;c=b.pixels.numBlocksY;h+=0<b.width%h?1:0;n=c+(0<b.height%
c?1:0);b.pixels.blocks=Array(h*n);k=1E9;for(A=z=0;n>A;A++)for(var E=0;h>E;E++){var d=0,c=new DataView(a,g,Math.min(10,a.byteLength-g)),e={};b.pixels.blocks[z++]=e;var f=c.getUint8(0);if(d++,e.encoding=63&f,3<e.encoding)throw"Invalid block encoding ("+e.encoding+")";if(2!==e.encoding){if(0!==f&&2!==f){if(f>>=6,e.offsetType=f,2===f)e.offset=c.getInt8(1),d++;else if(1===f)e.offset=c.getInt16(1,!0),d+=2;else{if(0!==f)throw"Invalid block offset type";e.offset=c.getFloat32(1,!0);d+=4}if(k=Math.min(e.offset,
k),1===e.encoding)if(f=c.getUint8(d),d++,e.bitsPerPixel=63&f,f>>=6,e.numValidPixelsType=f,2===f)e.numValidPixels=c.getUint8(d),d++;else if(1===f)e.numValidPixels=c.getUint16(d,!0),d+=2;else{if(0!==f)throw"Invalid valid pixel count type";e.numValidPixels=c.getUint32(d,!0);d+=4}}if(g+=d,3!=e.encoding)if(0===e.encoding){c=(b.pixels.numBytes-1)/4;if(c!==Math.floor(c))throw"uncompressed block has invalid length";d=new ArrayBuffer(4*c);f=new Uint8Array(d);f.set(new Uint8Array(a,g,4*c));d=new Float32Array(d);
for(f=0;f<d.length;f++)k=Math.min(k,d[f]);e.rawData=d;g+=4*c}else 1===e.encoding&&(c=Math.ceil(e.numValidPixels*e.bitsPerPixel/8),d=new ArrayBuffer(4*Math.ceil(c/4)),f=new Uint8Array(d),f.set(new Uint8Array(a,g,c)),e.stuffedData=new Uint32Array(d),g+=c)}else g++,k=Math.min(k,0)}a=(b.pixels.minValue=k,b.eofOffset=g,b);var g=null!=m.noDataValue?m.noDataValue:J.defaultNoDataValue,h=m.encodedMaskData,e=m.returnMask,c=0,n=a.pixels.numBlocksX,k=a.pixels.numBlocksY,z=Math.floor(a.width/n),A=Math.floor(a.height/
k),E=2*a.maxZError,h=h||(a.mask?a.mask.bitset:null),t,b=new (m.pixelType||Float32Array)(a.width*a.height);e&&h&&(t=new Uint8Array(a.width*a.height));for(var u,v,e=new Float32Array(z*A),d=0;k>=d;d++)if(f=d!==k?A:a.height%k,0!==f)for(var F=0;n>=F;F++){var B=F!==n?z:a.width%n;if(0!==B){var l,p,q=d*a.width*A+F*z,H=a.width-B,r=a.pixels.blocks[c];if(2>r.encoding){if(0===r.encoding)l=r.rawData;else{l=r.stuffedData;p=r.bitsPerPixel;u=r.numValidPixels;v=r.offset;var K=E,N=e,L=a.pixels.maxValue,G=void 0,C=
void 0,D=void 0,I=(1<<p)-1,M=0,w=0,O=Math.ceil((L-v)/K);l[l.length-1]<<=8*(4*l.length-Math.ceil(p*u/8));for(G=0;u>G;G++)(0===w&&(D=l[M++],w=32),w>=p)?(C=D>>>w-p&I,w-=p):(w=p-w,C=(D&I)<<w&I,D=l[M++],w=32-w,C+=D>>>w),N[G]=O>C?v+C*K:L;l=e}p=0}else x=2===r.encoding?0:r.offset;var y;if(h)for(v=0;f>v;v++){7&q&&(y=h[q>>3],y<<=7&q);for(u=0;B>u;u++)7&q||(y=h[q>>3]),128&y?(t&&(t[q]=1),b[q++]=2>r.encoding?l[p++]:x):(t&&(t[q]=0),b[q++]=g),y<<=1;q+=H}else if(2>r.encoding)for(v=0;f>v;v++){for(u=0;B>u;u++)b[q++]=
l[p++];q+=H}else for(v=0;f>v;v++){for(u=0;B>u;u++)b[q++]=x;q+=H}if(1===r.encoding&&p!==r.numValidPixels)throw"Block and Mask do not match";c++}}x=t;t={width:a.width,height:a.height,pixelData:b,minValue:a.pixels.minValue,maxValue:a.pixels.maxValue,noDataValue:g};x&&(t.maskData=x);m.returnEncodedMask&&a.mask&&(t.encodedMaskData=a.mask.bitset?a.mask.bitset:null);if(m.returnFileInfo&&(t.fileInfo=P(a),m.computeUsedBitDepths)){m=t.fileInfo;x=a.pixels.numBlocksX*a.pixels.numBlocksY;y={};for(l=0;x>l;l++)p=
a.pixels.blocks[l],0===p.encoding?y.float32=!0:1===p.encoding?y[p.bitsPerPixel]=!0:y[0]=!0;x=Object.keys(y);m.bitDepths=x}return t}},P=function(a){return{fileIdentifierString:a.fileIdentifierString,fileVersion:a.fileVersion,imageType:a.imageType,height:a.height,width:a.width,maxZError:a.maxZError,eofOffset:a.eofOffset,mask:a.mask?{numBlocksX:a.mask.numBlocksX,numBlocksY:a.mask.numBlocksY,numBytes:a.mask.numBytes,maxValue:a.mask.maxValue}:null,pixels:{numBlocksX:a.pixels.numBlocksX,numBlocksY:a.pixels.numBlocksY,
numBytes:a.pixels.numBytes,maxValue:a.pixels.maxValue,minValue:a.pixels.minValue,noDataValue:this.noDataValue}}};return J});