//>>built
define(["../../core/declare","dojo/_base/array","dojo/_base/lang","../Filter"],function(f,g,h,k){return f([k],{declaredClass:"esri.processors.filters.TrackFilter",normalizeCtorArgs:function(a){return"string"==typeof a&&(a={trackIdField:a}),a},getDefaults:function(){return h.mixin(this.inherited(arguments),{idField:"id",parentField:"parent"})},trackIdField:null,idField:null,parentField:null,run:function(a){if(this.trackIdField&&a){var c,b,d,e=a.removed||[],f=a.added||[];if(e.length)for(b=0,d=e.length;d>
b;b++)c=e[b],this._removeItemFromOutput(c,this.idField);f.length&&this.output.addMany(a.added.map(function(a){return a[this.parentField]=a.attributes[this.trackIdField],a}.bind(this)))}},_getIndexOfItem:function(a,c,b){var d=a[c];return b.findIndex(function(a){return a[c]===d},this)},_removeItemFromOutput:function(a,c){var b,d=a[c];return b=this._getIndexOfItem(a,c,this.output),-1!==b&&this.output.removeAt(b),{index:b,id:d,parent:a[this.parentField]}},_getItemsByParent:function(a,c){return c.filter(function(b){return b[this.parentField]===
a},this)},_getTracksAffectedByChanges:function(a){a=a||{};var c=a.added||[],b=[];if(c=c.concat(a.removed||[]),c.length)for(var d=0,e=c.length;e>d;d++)a=c[d],-1===g.indexOf(b,a[this.parentField])&&b.push(a[this.parentField]);return b}})});