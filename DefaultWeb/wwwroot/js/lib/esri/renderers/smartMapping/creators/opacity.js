//>>built
define("require exports ../support/utils ../../../core/promiseUtils ./support/utils dojo/_base/lang ../statistics/summaryStatistics ../../support/AuthoringInfo ../../support/AuthoringInfoVisualVariable".split(" "),function(t,l,k,f,g,m,n,p,q){function r(a){if(!(a&&a.layer&&(a.field||a.valueExpression||a.sqlExpression)))return f.reject(g.createError("opacity-visual-variable:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required"));var b=m.mixin({},a);
a=[0,1];var h=k.createLayerAdapter(b.layer,a);return b.layer=h,h?h.load().then(function(){var a=k.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression});return(a=g.verifyBasicFieldValidity(h,a,"opacity-visual-variable:invalid-parameters"))?f.reject(a):b}):f.reject(g.createError("opacity-visual-variable:invalid-parameters","'layer' must be one of these types: "+k.getLayerTypeLabels(a).join(", ")))}Object.defineProperty(l,"__esModule",{value:!0});l.createVisualVariable=
function(a){return r(a).then(function(b){var a;return a=b.statistics?f.resolve(b.statistics):n({layer:b.layer,field:b.field,valueExpression:b.valueExpression,sqlExpression:b.sqlExpression,sqlWhere:b.sqlWhere,normalizationType:b.normalizationField?"field":void 0,normalizationField:b.normalizationField,minValue:b.minValue,maxValue:b.maxValue}),a.then(function(a){var d=b.layer,e=b.field,d=(d=e&&"function"!=typeof e?d.getField(e):null)&&"date"===d.type,c=g.createStopValues(a),c=(d=g.getDefaultDataRange(a,
d,!0))||[c[0],c[4]],e={type:"opacity",field:e,valueExpression:b.valueExpression,valueExpressionTitle:b.valueExpressionTitle,normalizationField:b.normalizationField,stops:[{value:c[0],opacity:.3},{value:c[1],opacity:.7}],legendOptions:b.legendOptions},c=new q({type:"opacity",minSliderValue:a.min,maxSliderValue:a.max}),c=new p({visualVariables:[c]});return f.resolve({visualVariable:e,statistics:a,defaultValuesUsed:!!d,authoringInfo:c})})})}});