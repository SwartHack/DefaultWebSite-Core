//>>built
define("../../core/kebabDictionary ../../core/JSONSupport ../../core/lang ../../Graphic ../../layers/support/Field ../../geometry/SpatialReference ../../geometry/support/graphicsUtils ../../geometry/support/jsonUtils dojo/_base/lang".split(" "),function(l,v,w,x,y,p,z,A,B){l=l({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"});return v.createSubclass({declaredClass:"esri.tasks.support.FeatureSet",
getDefaults:function(){return B.mixin(this.inherited(arguments),{features:[]})},properties:{displayFieldName:null,exceededTransferLimit:null,features:{value:null,json:{read:function(b,a){var d,q=p.fromJSON(a.spatialReference);return d=b.map(function(a){var b=x.fromJSON(a);a=a.geometry&&a.geometry.spatialReference;return b.geometry&&!a&&(b.geometry.spatialReference=q),b}),a.transform&&this._hydrate(a.transform,a.geometryType,d),d}}},fields:{value:null,type:[y]},geometryType:{value:null,json:{read:l.fromJSON}},
spatialReference:{type:p}},toJSON:function(b){var a={hasZ:this.hasZ,hasM:this.hasM};return this.displayFieldName&&(a.displayFieldName=this.displayFieldName),this.fields&&(a.fields=this.fields.map(function(a){return a.toJSON()})),this.spatialReference?a.spatialReference=this.spatialReference.toJSON():this.features[0]&&this.features[0].geometry&&(a.spatialReference=this.features[0].geometry.spatialReference.toJSON()),this.features[0]&&(this.features[0].geometry&&(a.geometryType=A.getJsonType(this.features[0].geometry)),
a.features=z._encodeGraphics(this.features,b)),a.exceededTransferLimit=this.exceededTransferLimit,a.transform=this.transform,w.fixJson(a)},quantize:function(b){var a,d,q=b.translate[0],l=b.translate[1],r=b.scale[0],t=b.scale[1],n=this.features,h=function(a,m,b){var c,u,k,e,f,g,h,d=[];c=0;for(u=a.length;u>c;c++)k=a[c],0<c?(g=m(k[0]),h=b(k[1]),(g!==e||h!==f)&&(d.push([g-e,h-f]),e=g,f=h)):(e=m(k[0]),f=b(k[1]),d.push([e,f]));return 0<d.length?d:null},C=function(a,m,b){return"point"===a?function(a){return a.x=
m(a.x),a.y=b(a.y),a}:"polyline"===a||"polygon"===a?function(a){var c,d,e,f,g;e=a.rings||a.paths;g=[];c=0;for(d=e.length;d>c;c++)f=e[c],(f=h(f,m,b))&&g.push(f);return 0<g.length?(a.rings?a.rings=g:a.paths=g,a):null}:"multipoint"===a?function(a){var c;return c=h(a.points,m,b),0<c.length?(a.points=c,a):null}:"extent"===a?function(a){return a}:void 0}(this.geometryType,function(a){return Math.round((a-q)/r)},function(a){return Math.round((l-a)/t)});a=0;for(d=n.length;d>a;a++)C(n[a].geometry)||(n.splice(a,
1),a--,d--);return this.transform=b,this},_hydrate:function(b,a,d){if(b){var l=b.translate[0],p=b.translate[1],r=b.scale[0],t=b.scale[1],n=function(a,b,d){return"esriGeometryPoint"===a?function(a){a.x=b(a.x);a.y=d(a.y)}:"esriGeometryPolyline"===a||"esriGeometryPolygon"===a?function(a){var m,c,h,k,e,f,g,l=a.rings||a.paths;a=0;for(m=l.length;m>a;a++)for(k=l[a],c=0,h=k.length;h>c;c++)e=k[c],0<c?(f+=e[0],g+=e[1]):(f=e[0],g=e[1]),e[0]=b(f),e[1]=d(g)}:"esriGeometryEnvelope"===a?function(a){a.xmin=b(a.xmin);
a.ymin=d(a.ymin);a.xmax=b(a.xmax);a.ymax=d(a.ymax)}:"esriGeometryMultipoint"===a?function(a){var f,c,h,k,e=a.points;a=0;for(f=e.length;f>a;a++)c=e[a],0<a?(h+=c[0],k+=c[1]):(h=c[0],k=c[1]),c[0]=b(h),c[1]=d(k)}:void 0}(a,function(a){return a*r+l},function(a){return p-a*t});b=0;for(a=d.length;a>b;b++)d[b].geometry&&n(d[b].geometry)}}})});