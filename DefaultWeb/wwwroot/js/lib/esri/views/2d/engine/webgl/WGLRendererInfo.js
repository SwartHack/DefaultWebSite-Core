//>>built
define("require exports ../../../../geometry/support/scaleUtils ../../../../core/screenUtils ../../../../renderers/support/utils ./Utils".split(" "),function(u,v,r,g,t,l){function n(b,a){var e=a.length;if(b<a[0].value||1===e)return a[0].size;for(var c=1;e>c;c++)if(b<a[c].value)return a[c-1].size+(b-a[c-1].value)/(a[c].value-a[c-1].value)*(a[c].size-a[c-1].size);return a[e-1].size}return function(){function b(a){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);
this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.vvSizeFieldStopsValues=new Float32Array(6);this.vvSizeFieldStopsSizes=new Float32Array(6);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this.symbolLevels.push(0)}return Object.defineProperty(b.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,
configurable:!0}),Object.defineProperty(b.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"vvMaterialParams",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),b.prototype.updateHeatmapParameters=function(a){var e=a.blurRadius,c=Math.round(4.5*a.blurRadius),q=2*c+1;this._heatmapParameters||(this._heatmapParameters={radius:e,blurRadius:c,kernelSize:q,refreshIntensityKernel:!0,
intensityKernel:null,color:null,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity});for(var d=this._heatmapParameters,b=a.colorStops,f,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;16>m;m++){var h=b[Math.min(m,b.length-1)];g[m]=h.ratio;f=4*m;k[f+0]=h.color[0]/255;k[f+1]=h.color[1]/255;k[f+2]=h.color[2]/255;k[f+3]=1<h.color[3]?h.color[3]/255:h.color[3];
l.premultiplyAlpha(k,f,!0)}d.color={values:g,colors:k,refreshColorRamp:!0};1E-6<Math.abs(d.radius-a.radius)&&(d.radius=e,d.blurRadius=c,d.kernelSize=q,d.refreshIntensityKernel=!0);d.maxPixelIntensity=a.maxPixelIntensity;d.minPixelIntensity=a.minPixelIntensity},b.prototype.updateVisualVariables=function(a,e){var c=this._vvMaterialParameters;if(c.vvOpacityEnabled=!1,c.vvSizeEnabled=!1,c.vvColorEnabled=!1,c.vvRotationEnabled=!1,a){var b=a.size;if(b){if(c.vvSizeEnabled=!0,b.minMaxValue){var d=b.minMaxValue,
p=void 0,f=void 0;l.isDefined(d.minSize)&&l.isDefined(d.maxSize)&&(l.isNumber(d.minSize)&&l.isNumber(d.maxSize)?(p=g.pt2px(d.minSize),f=g.pt2px(d.maxSize)):(f=e.scale,p=g.pt2px(n(f,d.minSize.stops)),f=g.pt2px(n(f,d.maxSize.stops))));this.vvSizeMinMaxValue.set([d.minDataValue,d.maxDataValue,p,f])}if(b.scaleStops&&(this.vvSizeScaleStopsValue=g.pt2px(n(e.scale,b.scaleStops.stops))),b.unitValue)this.vvSizeUnitValueToPixelsRatio=r.getMetersPerUnitForSR(e.spatialReference)/t.meterIn[b.unitValue.unit]/e.resolution;
b.fieldStops&&(this.vvSizeFieldStopsValues.set(b.fieldStops.values),this.vvSizeFieldStopsSizes.set(b.fieldStops.sizes))}(e=a.color)&&(c.vvColorEnabled=!0,this.vvColorValues.set(e.values),this.vvColors.set(e.colors));(e=a.opacity)&&(c.vvOpacityEnabled=!0,this.vvOpacityValues.set(e.values),this.vvOpacities.set(e.opacities));(a=a.rotation)&&(c.vvRotationEnabled=!0,c.vvRotationType=a.type)}},b}()});