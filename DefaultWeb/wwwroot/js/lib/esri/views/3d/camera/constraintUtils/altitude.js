//>>built
define("require exports ../../lib/glMatrix ../../support/mathUtils ../../support/intersectionUtils ./common".split(" "),function(w,e,h,n,p,k){function m(b,d,c){void 0===c&&(c=k.defaultApplyOptions);var a=b.state.constraints.altitude;if(!b.state.isGlobal||!a||2===c.interactionType&&k.hasConstraintType(c.selection,1))return 0;var a=b.state.constraints.altitude,f=q,a=(f.min=a.min,f.max=a.max,f),g=c.interactionType;if(0!==g){var f=a.min,h=a.max,l=c.interactionStartCamera;c=c.interactionFactor;var g=2===
g||1===g,e=m(b,l),l=0===e?0:b.renderCoordsHelper.getAltitude(l.eye);a.min=f;a.max=h;k.adjustRangeForInteraction(e,l,g,c,.05*l,a)}b=b.renderCoordsHelper.getAltitude(d.eye);b=n.clamp(b,a.min,a.max)-b;return 1E-6>=Math.abs(b)?0:b}function r(b,d,c,a){return b.renderCoordsHelper.worldUpAtPosition(d.eye,a),h.vec3d.scale(a,c),a}Object.defineProperty(e,"__esModule",{value:!0});e.apply=function(b,d,c,a){void 0===c&&(c=k.defaultApplyOptions);void 0===a&&(a=d);a!==d&&a.copyFrom(d);var f=m(b,d,c);if(0===f)return!1;
var g=b.renderCoordsHelper,e=g.getAltitude(d.eye)+f;b=k.interactionDirectionTowardsConstraintMinimization(b,d,c.interactionDirection,r(b,d,n.sign(f),t),u);c=h.vec3d.set(d.viewForward,v);return g.intersectManifold(d.eye,b,e,a.eye)||g.setAltitude(e,a.eye),p.closestPointOnRay(d.eye,c,d.center,d.center),a.markViewDirty(),!0};e.error=m;var q={min:0,max:0},u=h.vec3d.create(),t=h.vec3d.create(),v=h.vec3d.create()});