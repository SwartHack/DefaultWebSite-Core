//>>built
define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../.././../../geometry ./PointToPointMeasurementView".split(" "),function(g,h,k,l,e,f){return function(){function d(a,b){this._tempPickRequest=new f.PickRequest;this.model=a;this.view=b;this.reset()}return d.prototype.reset=function(){this.model.reset()},d.prototype.clearMeasurement=function(){this.model.clearMeasurement()},d.prototype.hoverAt=function(a){this._updateHoveredHandle(a);
a=this._pick(a,!1);a.mapPoint&&(this.model.cursorPoint=a.mapPoint)},d.prototype.startAt=function(a,b){void 0===b&&(b="mouse");b=this._pick(a);return b.mapPoint?(this.model.startPoint=b.mapPoint,this.model.startPointSurfaceLocation=this._surfaceLocation(b.mapPoint,b.type),this.model.hoveredHandle="start",!0):(this._updateHoveredHandle(a),!1)},d.prototype.endAt=function(a,b){void 0===b&&(b="mouse");var c=this._pick(a);return c.mapPoint&&!this.view.overlappingHandles(c.mapPoint,this.model.startPoint)?
(this.model.endPoint=c.mapPoint,this.model.endPointSurfaceLocation=this._surfaceLocation(c.mapPoint,c.type),"mouse"===b?this.model.hoveredHandle="end":this.model.hoveredHandle=null,!0):(this._updateHoveredHandle(a),!1)},d.prototype.handleAt=function(a){return this._pick(a,!0).handle},d.prototype.moveHandleTo=function(a,b){b=this._clipToScreen(b);var c=this._pick(b);if(c.mapPoint)if("start"===a){if(!this.view.overlappingHandles(c.mapPoint,this.model.endPoint))return this.model.startPoint=c.mapPoint,
this.model.startPointSurfaceLocation=this._surfaceLocation(c.mapPoint,c.type),this.model.hoveredHandle="start",!0}else if("end"===a&&!this.view.overlappingHandles(c.mapPoint,this.model.startPoint))return this.model.endPoint=c.mapPoint,this.model.endPointSurfaceLocation=this._surfaceLocation(c.mapPoint,c.type),this.model.hoveredHandle="end",!0;return this._updateHoveredHandle(b),!1},d.prototype._pick=function(a,b){void 0===b&&(b=!1);var c=this._tempPickRequest;return c.screenPoint=a,c.pickHandles=
b,this.view.pick(c)},d.prototype._clipToScreen=function(a){return new e.ScreenPoint({x:Math.max(0,Math.min(this.model.sceneView.width,a.x)),y:Math.max(0,Math.min(this.model.sceneView.height,a.y))})},d.prototype._updateHoveredHandle=function(a){a=this._pick(a,!0);this.model.hoveredHandle=a.handle},d.prototype._surfaceLocation=function(a,b){return"surface"===b?"on-the-surface":a.z>=this.view.getElevation(a)?"above-the-surface":"below-the-surface"},d}()});