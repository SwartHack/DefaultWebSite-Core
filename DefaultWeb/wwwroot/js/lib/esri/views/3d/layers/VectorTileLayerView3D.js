//>>built
define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all ../../../core/accessorSupport/decorators ../../../core/promiseUtils ../../../core/watchUtils ../../vectorTiles/SchemaHelper ../../vectorTiles/TileHandler ../../vectorTiles/renderers/Renderer ./TiledLayerView3D".split(" "),function(t,u,h,f,k,c,l,m,n,p,q,r){return function(g){function a(d){return g.call(this)||this}return h(a,g),a.prototype.initialize=function(){var d,b=this,a=this._getTileInfoSupportError(this.layer.compatibleTileInfo256,
this.layer.fullExtent);a?this.addResolvingPromise(l.reject(a)):d=m.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){var a=b.view.basemapTerrain.tilingScheme,d=a.pixelSize[0];b.schemeHelper=new n(d,b.view.spatialReference.isWGS84);d=256===d?b.layer.compatibleTileInfo256:b.view.spatialReference.isWGS84?b.layer.compatibleTileInfo512:b.layer.tileInfo;if(a=b._getTileInfoCompatibilityError(d,a))throw a;b.tileInfo=d;b._updateMinMaxDataLevel()});var c,a=this._initializeTileHandler();
this.tileHandler=a[0];this.renderer=a[1];this._tileHandlerPromise=c=a[2];this.watch("layer.currentStyleInfo",function(){var a,d,e;b._tileHandlerPromise.isFulfilled()||b._tileHandlerPromise.cancel("cancel");e=b._initializeTileHandler();a=e[0];d=e[1];e=e[2];b._tileHandlerPromise=c;e.then(function(){var c=b.tileHandler;b.renderer=d;b.tileHandler=a;b.emit("data-changed");c.destroy()})});d=k([d,c]);this.addResolvingPromise(d)},a.prototype.destroy=function(){this.renderer=null;this.tileHandler.destroy();
this.tileHandler=null},a.prototype._initializeTileHandler=function(){var a=new p(this.layer,function(){},1),b=new q,c=a.start();return c.then(function(){b.initialize(a.spriteMosaic,a.glyphMosaic,!1)}),[a,b,c]},f([c.property({aliasOf:"layer.fullExtent"})],a.prototype,"fullExtent",void 0),f([c.property()],a.prototype,"layer",void 0),f([c.property()],a.prototype,"updatingPercentageValue",void 0),a=f([c.subclass("esri.views.3d.layers.VectorTileLayerView3D")],a)}(c.declared(r))});