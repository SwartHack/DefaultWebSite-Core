//>>built
define(["require","exports"],function(h,k){Object.defineProperty(k,"__esModule",{value:!0});h=function(){function e(a){a&&this.update(a)}return e.prototype.update=function(a){a&&(this.definition?this.definition.copyFrom(a):this.definition=a.clone());this._updatePrecomputedVariables();this._updatePixelFlow()},e.prototype._updatePrecomputedVariables=function(){var a=this.definition,b=a.compared,c=b.sourceZoom,d=b.targetZoom;this._sl=c>d?1:-1;this._panPixelsAtSource=b.pan*a.source.pixelsPerPanAtZoom(c);
a=(a.source.pixelsPerRotateAtZoom(c)+a.target.pixelsPerRotateAtZoom(d))/2;this._rotatePixels=b.rotate*a},e.prototype._updatePixelFlow=function(){var a,b,c=this.definition.compared.sourceZoom,d=this.definition.compared.targetZoom,e=this.definition.hasZoom,f=this.definition.hasPan,g=this.definition.hasRotate;a=f&&e?(d/c-1)/(-1/(this._sl*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource):0;b=e&&g?Math.log(c/d)/Math.LN2*this._sl*this.definition.halfWindowSize/this._rotatePixels:0;this._rotatePixelFlow=
this._panPixelFlow=this._zoomPixelFlow=0;c=this.definition.desiredPixelFlow;e&&f&&g?(d=a+b+a*b,this._zoomPixelFlow=a*b/d*c,this._panPixelFlow=b/d*c,this._rotatePixelFlow=a/d*c):e&&f?(d=1+a,this._zoomPixelFlow=a/d*c,this._panPixelFlow=1/d*c):e&&g?(d=1+b,this._zoomPixelFlow=b/d*c,this._rotatePixelFlow=1/d*c):f&&g?(a=this._panPixelsAtSource/this._rotatePixels,d=1+a,this._panPixelFlow=a/d*c,this._rotatePixelFlow=1/d*c):f?this._panPixelFlow=c:e?this._zoomPixelFlow=c:g&&(this._rotatePixelFlow=c);g?this.time=
this.rotateTime:e?this.time=this.zoomTime:f?this.time=this.panTime:this.time=0},Object.defineProperty(e.prototype,"zoomTime",{get:function(){return this.definition.hasZoom?Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2*this._sl*this.definition.halfWindowSize/this._zoomPixelFlow:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panTime",{get:function(){if(this.definition.hasPan){if(this.definition.hasZoom){var a=-1/(this._sl*this.definition.halfWindowSize)*
Math.LN2;return Math.log(this._zoomPixelFlow/this._panPixelFlow*this._panPixelsAtSource*a+1)/(a*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotateTime",{get:function(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0},enumerable:!0,configurable:!0}),e.prototype._interpolateComponentsZoom=function(a){if(this.definition.hasZoom){var b=this.definition.compared.sourceZoom,
c=this.definition.compared.targetZoom;return(b*Math.pow(b/c,-a)-b)/(c-b)}return a},e.prototype._interpolateComponentsPan=function(a){if(this.definition.hasPan&&this.definition.hasZoom){var b=-1/(this._sl*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*this._panPixelFlow*(Math.pow(2,b*a*this.time)-1)/(b*Math.LN2)}return a},e.prototype._interpolateComponentsRotate=function(a){return a},e.prototype.interpolateComponentsAt=function(a,b){a=Math.min(Math.max(a,0),1);
var c=this._interpolateComponentsZoom(a),d=this._interpolateComponentsPan(a);a=this._interpolateComponentsRotate(a);return b?(b.zoom=c,b.pan=d,b.rotate=a):b={zoom:c,pan:d,rotate:a},b},e}();k.Segment=h;k["default"]=h});