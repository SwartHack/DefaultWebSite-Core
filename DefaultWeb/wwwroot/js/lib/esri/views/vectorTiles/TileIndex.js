//>>built
define(["require","exports","../2d/tiling/TileKey"],function(k,l,g){return function(){function f(a){if(!("index"in a))throw Error("The tilemap is missing the 'index' property.");this._tilemap=a.index}return f.prototype.dataKey=function(a){var c=[a];if(0>a.level||0>a.row||0>a.col||0<a.row>>a.level||0<a.col>>a.level)return null;for(;0!==a.level;)a=new g(a.level-1,a.row>>1,a.col>>1,a.world),c.push(a);var b,d=this._tilemap,e=c.pop();if(1===d)return e;for(;c.length;){a=c.pop();b=e.level+1;var f=2*e.row,
h=2*e.col;if(b=[g.getId(b,f,h,a.world),g.getId(b,f,h+1,a.world),g.getId(b,f+1,h,a.world),g.getId(b,f+1,h+1,a.world)].indexOf(a.id),d){if(0===d[b]){e=null;break}if(1===d[b]){e=a;break}e=a;d=d[b]}}return e},f.prototype.forEach=function(a,c,b,d,e){this._callback=e;this._maxLevel=c+a;this._forEach(this._tilemap,c,b,d)},f.prototype._forEach=function(a,c,b,d){0!==a&&(this._callback(c,b,d),c!==this._maxLevel&&"object"==typeof a&&(this._forEach(a[0],c+1,2*b,2*d),this._forEach(a[1],c+1,2*b,2*d+1),this._forEach(a[2],
c+1,2*b+1,2*d),this._forEach(a[3],c+1,2*b+1,2*d+1)))},f}()});