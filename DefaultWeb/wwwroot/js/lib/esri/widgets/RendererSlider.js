//>>built
require({cache:{"url:esri/widgets/RendererSlider/templates/RendererSlider.html":'\x3cdiv class\x3d"${_css.container}"\x3e\n  \x3cdiv class\x3d"${_css.topLabelNode} ${_css.topLabelNodeHover}" data-dojo-attach-point\x3d"_topNode"\x3e\n    \x3cspan data-dojo-attach-point\x3d"_topNodeSpan"\x3e\x3c/span\x3e \n  \x3c/div\x3e\n  \x3cdiv class\x3d"${_css.slidernode}" data-dojo-attach-point\x3d"_sliderNode"\x3e\n    \x3cdiv class\x3d"${_css.sliderarea}" data-dojo-attach-point\x3d"_sliderArea"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"${_css.sliderarearight}" data-dojo-attach-point\x3d"_sliderAreaRight"\x3e\x3c/div\x3e\n  \x3c/div\x3e\n  \x3cdiv class\x3d"${_css.bottomLabelNode} ${_css.bottomLabelNodeHover}" data-dojo-attach-point\x3d"_botNode"\x3e\n    \x3cspan  data-dojo-attach-point\x3d"_bottomNodeSpan"\x3e\x3c/span\x3e\n  \x3c/div\x3e\n\x3c/div\x3e'}});
define("./Widgette ./DateTimeTextBox ./RendererSlider/sliderUtils ../core/lang ../core/numberUtils ../renderers/support/utils dijit/_TemplatedMixin dijit/form/NumberTextBox dojo/_base/array dojo/_base/lang dojo/dnd/move dojo/dom-construct dojo/dom-style dojo/dom-class dojo/on dojo/text!./RendererSlider/templates/RendererSlider.html".split(" "),function(H,C,w,E,z,F,I,D,x,f,J,r,t,G,l,K){return H.createSubclass([I],{declaredClass:"esri.widgets.RendererSlider",templateString:K,_visibleLabels:["data",
"handle"],_roundedDataLabels:[],_roundedHandleLabels:[],_ratioLabels:[],_minRatioLabel:"",_maxRatioLabel:"",_sliderHeight:null,_isZoomed:!1,_minZoomLabel:"",_maxZoomLabel:"",_maximumNumberEditor:null,_minimumNumberEditor:null,_valueDifferenceByIndex:[],_currentTopValue:[],_isLTR:!0,_ctrlDown:!1,_histogramSurface:null,_css:null,_minPrecisionForSmallNumbers:3,_handles:[],properties:{loaded:!1,intermediateChanges:!0,type:null,minimum:0,maximum:100,values:[],precision:2,handles:[],handlesVisible:!0,primaryHandleIndex:null,
ticksVisible:!0,labelsVisible:!0,ratioLabelsVisible:null,minLabel:null,maxLabel:null,isDate:!1},constructor:function(a,b){this._css={container:"esri-renderer-slider",slidernode:"esri-slider-node",sliderarea:"esri-slider-area",sliderarearight:"esri-slider-area-right",moveable:"esri-moveable",handler:"esri-handle",handlerSpan:"esri-handle-span",handlerContainer:"esri-handle-container",handlerLabel:"esri-handle-label",handlerLabelSpan:"esri-handle-label-span",topLabelNode:"esri-top-label-node",bottomLabelNode:"esri-bottom-label-node",
topLabelNodeHover:"esri-top-label-node-hover",bottomLabelNodeHover:"esri-bottom-label-node-hover",heatmapTick:"esri-heatmap-tick",handlerTick:"esri-handler-tick",handlerTickTop:"esri-handler-tick-top",handlerTickBottom:"esri-handler-tick-bottom"};this.labelsVisible=a.labelsVisible||this._visibleLabels},startup:function(){this.inherited(arguments);var a=t.get(this._sliderArea,"height");if(this._sliderHeight=a?a:200,this._checkMinMaxDefaults(),this._isLTR=this.isLeftToRight(),!this._isLTR){var a=t.get(this._sliderNode,
"padding-left")+t.get(this._sliderNode,"padding-right"),b=Math.round(t.get(this._sliderNode,"width"));this._sliderNodeWidth_RTL=a+b}this._updateRoundedLabels();this._generateMoveables();this._generateMinMaxEditors();this._generateCtrlKeyListener();this.watch("values",this._valuesChange);this.watch("minimum, maximum, ratioLabelsVisible",this._updateTimeout);this.loaded=!0;this.emit("load")},setValue:function(a,b,c){var d=this.get("values"),e=d.slice(0);"object"==typeof d[0]?e[a].value=b:e[a]=b;(this.intermediateChanges||
c)&&(this.values=e);c?this.emit("stop",{values:this.get("values")}):this.emit("slide",{values:e})},_updateTimeout:function(a,b,c){this._updateSlider()},_updateSlider:function(){this._reset();this._checkMinMaxDefaults();this._updateRoundedLabels();this._generateMoveables();this._generateMinMaxEditors();this._generateCtrlKeyListener()},_checkMinMaxDefaults:function(){var a,b,c=this.values;this.minimum===this.maximum&&c&&0<c.length&&(isNaN(c[0])?this.set({minimum:0,maximum:2*c[0].value}):this.set({minimum:0,
maximum:2*c[0]}));c&&0<c.length&&(a=isNaN(c[0])?c[0].value:c[0],this.minimum>a&&(this.minimum=a),b=isNaN(c[c.length-1])?c[c.length-1].value:c[c.length-1],this.maximum<b&&(this.maximum=b));this.precision=w.getCombinedPrecision(this.minimum,this.maximum)},_calculateValueFromHandlePosition:function(a){var b=this.get("minimum"),c=this.get("maximum"),d=this.get("precision"),e=this.get("step")||Math.pow(10,-d);return 1>=b&&-1<=b&&1>=c&&-1<=c||d>=this._minPrecisionForSmallNumbers?(a*(c-b)+b)/e*e:parseFloat((Math.round((a*
(c-b)+b)/e)*e).toFixed(d))},_generateMoveables:function(){var a,b=this._sliderNode,c=this._sliderHeight,d=this.get("minimum"),e=this.get("maximum"),g=this.get("labelsVisible"),h=this.get("ticksVisible"),q=f.hitch(this,this.setValue),u=this.get("values");this._updateMinMaxLabels();this.moveables=a=x.map(u,f.hitch(this,function(k,m){var n,p,u,l,v,B,A;return"object"==typeof k&&k.hidden?null:("object"==typeof k&&(k=k.value),n=r.create("div",{style:this._getHandleStyleString(k),className:this._css.moveable},
b),n.handleContainer=B=r.create("div",{className:this._css.handlerContainer},n),n.arrowSpan=l=r.create("span",{className:this._css.handlerSpan},B),n.handler=p=r.create("div",{className:this._css.handler},B),"HeatmapSlider"!==this.type&&(!0===g||"object"==typeof g&&-1!==x.indexOf(g,"handles"))&&(u=this._generateHandleLabel(n,m)),h&&this._generateHandleTicks(n,m),v=new J.constrainedMoveable(n,{handle:B,within:!0,constraints:f.hitch(this,function(){return{t:0,l:this._isLTR?0:this._sliderNodeWidth_RTL,
w:0,h:c}})}),v.onMoveStart=f.hitch(this,function(b){var d,e,g,q,h,u,k,p,y=this.handles,l=x.indexOf(y,m);this._currentTopValue[m]=b.node.style.top;A=Number(b.node.style.top.replace("px",""));n.labelNode&&n.labelNode._autoPositioned&&(t.set(n.labelNode,"top","3px"),n.labelNode._autoPositioned=!1);w._autoPositionHandleLabels(this.get("moveables"));n._numberEditor&&(n._numberEditor.destroy(),n._numberEditor=null);m!==this.primaryHandleIndex?(y&&0<y.length?(d=null!==y[l-1]?y[l-1]:null,e=null!==y[l+1]?
y[l+1]:null,g=a[d],q=a[e]):(g=a[m-1],q=a[m+1]),g&&q?(h=g.style.top,u=q.style.top,k=Number(h.replace("px","")),p=Number(u.replace("px","")),v.constraints=f.hitch(this,function(){return{t:p+2,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:c-p-(c-k+4)}})):g?(h=g.style.top,k=Number(h.replace("px","")),v.constraints=f.hitch(this,function(){return{t:0,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:c-(c-k+2)}})):q&&(u=q.style.top,p=Number(u.replace("px","")),v.constraints=f.hitch(this,function(){return{t:p+
2,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:c-(p+2)}}))):(y&&0<y.length?(d=null!==y[l-1]?y[l-1]:null,e=null!==y[l+1]?y[l+1]:null,g=a[d],q=a[e]):(g=a[m-1],q=a[m+1]),g&&q&&(h=g.style.top,u=q.style.top,k=Number(h.replace("px","")),p=Number(u.replace("px","")),v.constraints=f.hitch(this,function(){return{t:2,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:c-4}})))}),v.onMoved=f.hitch(this,function(b){var g,h,n,p,k,l,r,v;if(m===this.primaryHandleIndex&&(n=Number(this._currentTopValue[m].replace("px",
""))-Number(b.node.style.top.replace("px","")),this._currentTopValue[m]=b.node.style.top,x.forEach(a,f.hitch(this,function(a,b){!a||b===m||(p=Number(a.style.top.replace("px","")),l=p-n,g=1-Number(l/c),h=this._calculateValueFromHandlePosition(g),d>h||h>e)||(t.set(a,"top",l+"px"),q(b,h,!1),a.labelNode&&(a.labelNode.spanNode.innerHTML=this.ratioLabelsVisible?this._getLabelValueFromIndex(b):this._formatValue(h.toFixed(6))))}))),g=1-Number(b.node.style.top.replace("px",""))/c,h=this._calculateValueFromHandlePosition(g),
m!==this.primaryHandleIndex&&this._ctrlDown&&(n=Number(this._currentTopValue[m].replace("px",""))-Number(b.node.style.top.replace("px","")),this._currentTopValue[m]=b.node.style.top,0===m?(p=Number(a[a.length-1].style.top.replace("px","")),k=p+n,k>c&&(k=c),0>k&&(k=0),t.set(a[a.length-1],"top",k+"px"),v=1-k/c,r=this._calculateValueFromHandlePosition(v),q(a.length-1,r,!1),a[a.length-1].labelNode&&(a[a.length-1].labelNode.spanNode.innerHTML=this._formatValue(r.toFixed(6)))):m===a.length-1&&(p=Number(a[0].style.top.replace("px",
"")),k=p+n,k>c&&(k=c),0>k&&(k=0),t.set(a[0],"top",k+"px"),v=1-k/c,r=this._calculateValueFromHandlePosition(v),q(0,r,!1),a[0].labelNode&&(a[0].labelNode.spanNode.innerHTML=this._formatValue(r.toFixed(6))))),q(m,h,!1),this._updateRoundedLabels(),u)b=this._formatValue(parseFloat(this._roundValue([h,parseFloat(this._getLabelValueFromIndex(m,!0))])[0]).toFixed(this.precision)),u.spanNode.innerHTML=this.ratioLabelsVisible?this._getLabelValueFromIndex(m):b;w._autoPositionHandleLabels(this.get("moveables"))}),
v.onMoveStop=f.hitch(this,function(a){var b,d,e;if(e=Number(a.node.style.top.replace("px","")),e===A)return void(A=null);if(b=1-e/c,d=this._calculateValueFromHandlePosition(b),q(m,d,!0),this._updateRoundedLabels(),u)a=z.format(parseFloat(z.round([d,parseFloat(this._getLabelValueFromIndex(m,!0))])[0]).toFixed(this.precision)),u.spanNode.innerHTML=this.ratioLabelsVisible?this._getLabelValueFromIndex(m):a;w._autoPositionHandleLabels(this.get("moveables"))}),this.handlesVisible||(t.set(p,"display","none"),
t.set(l,"display","none")),n)}));w._autoPositionHandleLabels(this.get("moveables"))},_reset:function(){x.forEach(this.moveables,f.hitch(this,function(a){a&&a.parentElement.removeChild(a)}));this.moveables=[]},_getHandleStyleString:function(a){var b=this.get("minimum"),c=this.get("maximum");return"top: "+Math.round((1-(a-b)/(c-b))*this._sliderHeight)+"px; "+("left: "+(this._isLTR?0:this._sliderNodeWidth_RTL)+"px;")},_generateHandleTicks:function(a,b){var c=this._css,d=c.handlerTick+" "+c.handlerTickTop,
e=c.handlerTick+" "+c.handlerTickBottom;b=0===b?e:d;"HeatmapSlider"===this.type&&(b+=c.heatmapTick);a.tick=r.create("div",{className:b},a)},_updateLabels:function(){this._updateMinMaxLabels();this._updateRoundedLabels()},_resetLabelPositions:function(){x.forEach(this.moveables,function(a){if(a){var b=a.labelNode;b&&(t.set(b,"top","3px"),a.labelNode._autoPositioned=!1)}})},_generateHandleLabel:function(a,b){var c,d;return c=r.create("div",{className:this._css.handlerLabel},a),d=r.create("span",{className:this._css.handlerLabelSpan,
innerHTML:this._getLabelValueFromIndex(b)},c),c.spanNode=d,a.labelNode=c,l(c,"click",f.hitch(this,function(){this._generateHandleLabelEditor(a,b)})),c},_updateMinMaxLabels:function(){var a,b,c,d,e,g,h=this.minimum,q=this.maximum,f=this.labelsVisible,k=this.minLabel,m=this.maxLabel,n=this._topNodeSpan,p=this._bottomNodeSpan,l=this._isZoomed,r=this._maxZoomLabel,v=this._minZoomLabel,t=this.ratioLabelsVisible,A=this._maxRatioLabel,w=this._minRatioLabel,z=this._roundedDataLabels;!1===f||"object"==typeof f&&
-1===x.indexOf(f,"data")?(n.innerHTML="",p.innerHTML=""):l?t?(n.innerHTML=A,p.innerHTML=w):(n.innerHTML=this._formatValue(r),p.innerHTML=this._formatValue(v)):t?(n.innerHTML=A,p.innerHTML=w):(a=isNaN(k)?k:this._roundValue([k,m])[0],b=isNaN(m)?m:this._roundValue([k,m])[1],c=isNaN(a)||null===a?k:this._formatValue(a),d=isNaN(b)||null===b?m:this._formatValue(b),e=this._formatValue(z[0])||this._formatValue(h),g=this._formatValue(z[1])||this._formatValue(q),n.innerHTML=d||g,p.innerHTML=c||e)},_formatValue:function(a){return"string"==
typeof a&&(a=Number(a)),this.isDate?F.formatDate(new Date(a),F.timelineDateFormatOptions):z.format(a)},_roundValue:function(a){return this.isDate?a.slice(0):z.round(a)},_updateRoundedLabels:function(){switch(this._roundedDataLabels=this._roundValue([this.minimum,this.maximum]),this.type){case "SizeSlider":case "ClassedSizeSlider":case "ClassedColorSlider":case "UnivariateColorSizeSlider":this._roundedHandleLabels=this._roundValue(this.values);break;case "ColorSlider":case "OpacitySlider":this._roundedHandleLabels=
this._roundValue(this._getValuesFromObject(this.values))}this._updateRatioLabels()},_updateRatioLabels:function(){var a,b,c=this.get("ratioLabelsVisible"),d=this.get("minimum"),e=this.get("maximum"),g=this._getValuesFromObject(this.values),h=[];if(c){if("percent"!==c&&"percentTotal"!==c)return void(c=null);"percent"===c?(x.forEach(g,function(a){h.push(this._getRatioFromValue(a))},this),a=this._formatValue(this._getRatioFromValue(d).toFixed(2)),b=this._formatValue(this._getRatioFromValue(e).toFixed(2))):
"percentTotal"===c&&(x.forEach(g,function(a){h.push(this._getRatioFromValue(a))},this),a=this._formatValue(this._getRatioFromValue(d).toFixed(2)),b=this._formatValue(this._getRatioFromValue(e).toFixed(2)));this._ratioLabels=h;this._minRatioLabel=a+"%";this._maxRatioLabel=b+"%"}},_generateMinMaxEditors:function(){!this.labelsVisible||"object"==typeof this.labelsVisible&&-1===x.indexOf(this.labelsVisible,"data")||"HeatmapSlider"===this.type?(G.remove(this._topNode,this._css.topLabelNodeHover),G.remove(this._botNode,
this._css.bottomLabelNodeHover)):(l(this._topNode,"click",f.hitch(this,this._generateMaxEditor)),l(this._botNode,"click",f.hitch(this,this._generateMinEditor)))},_generateMaxEditor:function(){if(!(this._maximumNumberEditor&&this._topLabelNode||this._isZoomed)){var a,b,c=this.get("minLabel"),d=this.get("maxLabel"),e=this.get("maximum");b=this.handles;(this._topNodeSpan.innerHTML="",this._topLabelNode=r.create("input",{type:"text"},this._topNode),a=b&&0<b.length?this.values[b[b.length-1]]:this.values[this.values.length-
1],"object"==typeof a&&(a=a.value),this.ratioLabelsVisible&&(a=this._getLabelValueFromIndex(this.values.length-1,!0).replace("%",""),e=Number(this._maxRatioLabel.replace("%",""))),this.isDate)?(b=new C({date:new Date(Number(e)),required:!0,constraints:{min:new Date(a),max:null}},this._topLabelNode),a={editor:b,editorPropName:"_maximumNumberEditor",spanNode:this._topNodeSpan,operator:"\x3c"},b.on("keydown",f.hitch(this,this._minMaxKeydownDateHandler,a)),b.on("blur",f.hitch(this,this._minMaxBlurDateValue,
a)),b.watch("date",f.hitch(this,this._minMaxUpdateDateValue,a))):(b=new D({value:Number(e),required:!0,constraints:{min:a,max:"percentTotal"===this.ratioLabelsVisible?100:null,places:"0,20"}},this._topLabelNode),l(b,"keydown",f.hitch(this,this._keydownHandler,{editor:b,originalValidate:!1})),l(b,"blur",f.hitch(this,this._minMaxBlurHandler,{editor:b,editorPropName:"_maximumNumberEditor",label:d,current:e,spanNode:this._topNodeSpan,index:1,minLabel:c,maxLabel:d,ratioLabel:this._maxRatioLabel})),l(b,
"change",f.hitch(this,this._minMaxChangeHandler,{label:d,current:e,spanNode:this._topNodeSpan,index:1,minLabel:c,maxLabel:d,ratioLabel:this._maxRatioLabel,handleValue:a,operator:"\x3c"})));this._maximumNumberEditor=b;b.startup();b.focus();b.textbox.select()}},_generateMinEditor:function(){if(!(this._minimumNumberEditor&&this._botLabelNode||this._isZoomed)){var a,b,c=this.minLabel,d=this.maxLabel,e=this.minimum;b=this.handles;(this._bottomNodeSpan.innerHTML="",this._botLabelNode=r.create("input",{type:"text"},
this._botNode),a=b&&0<b.length?this.values[b[0]]:this.values[0],"object"==typeof a&&(a=a.value),this.ratioLabelsVisible&&(a=String(this._getLabelValueFromIndex(0,!0)).replace("%",""),e=Number(this._minRatioLabel.replace("%",""))),this.isDate)?(b=new C({date:new Date(Number(e)),required:!0,constraints:{min:null,max:new Date(a)}},this._botLabelNode),a={editor:b,editorPropName:"_minimumNumberEditor",spanNode:this._bottomNodeSpan,operator:"\x3e"},b.on("keydown",f.hitch(this,this._minMaxKeydownDateHandler,
a)),b.on("blur",f.hitch(this,this._minMaxBlurDateValue,a)),b.watch("date",f.hitch(this,this._minMaxUpdateDateValue,a))):(b=new D({value:Number(e),required:!0,constraints:{max:a,min:"percentTotal"===this.ratioLabelsVisible?0:null,places:"0,20"}},this._botLabelNode),l(b,"keydown",f.hitch(this,this._keydownHandler,{editor:b,originalValidate:!1})),l(b,"blur",f.hitch(this,this._minMaxBlurHandler,{editor:b,editorPropName:"_minimumNumberEditor",label:c,current:e,spanNode:this._bottomNodeSpan,index:0,minLabel:c,
maxLabel:d,ratioLabel:this._minRatioLabel})),l(b,"change",f.hitch(this,this._minMaxChangeHandler,{label:c,current:e,spanNode:this._bottomNodeSpan,index:0,minLabel:c,maxLabel:d,ratioLabel:this._minRatioLabel,handleValue:a,operator:"\x3e"})));this._minimumNumberEditor=b;b.startup();b.focus();b.textbox.select()}},_minMaxBlurHandler:function(a,b){b=a.editor;var c=a.editorPropName,d=a.label,e=a.current,g=a.spanNode,h=a.index,f=a.minLabel,l=a.maxLabel;a=a.ratioLabel;f=isNaN(d)?d:this._roundValue([f,l])[h];
d=isNaN(f)||null===f?d:this._formatValue(f);e=this._formatValue(this._roundedDataLabels[h])||this._formatValue(e);this.labelsVisible||"object"==typeof this.labelsVisible&&-1!==x.indexOf(this.labelsVisible,"data")?this.ratioLabelsVisible?g.innerHTML=a:g.innerHTML=d||e:g.innerHTML="";b.destroy();this[c]=null},_minMaxChangeHandler:function(a,b){var c,d,e,g,f=a.label,q=a.current,l=a.spanNode,k=a.index,m=a.minLabel,n=a.maxLabel,p=a.ratioLabel,r=a.handleValue;a=a.operator;return("\x3c"===a?b<Number(r):
b>Number(r))||isNaN(b)||void 0===b?(c=isNaN(f)?f:this._roundValue([m,n])[k],d=isNaN(c)||null===c?f:this._formatValue(c),e=this._formatValue(this._roundedDataLabels[k])||this._formatValue(q),void(this.ratioLabelsVisible?l.innerHTML=p:l.innerHTML=d||e)):(g=this.ratioLabelsVisible?this._getValueFromPercent(b):b,l.innerHTML=this.ratioLabelsVisible?g:this._formatValue(b),this.set("\x3c"===a?"maximum":"minimum",g),this._reset(),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),
void this.emit("data-value-change",{min:this.minimum,max:this.maximum,values:E.clone(this.values)}))},_minMaxKeydownDateHandler:function(a,b){13===b.keyCode&&a.editor.isValid()&&setTimeout(f.hitch(this,this._destroyMinMaxHandleEditor,a),0)},_minMaxBlurDateValue:function(a,b){setTimeout(f.hitch(this,this._destroyMinMaxHandleEditor,a),0)},_destroyMinMaxHandleEditor:function(a){a.spanNode.innerHTML=this._formatValue(this.get("\x3c"===a.operator?"maximum":"minimum"));a.editor.destroy();this[a.editorPropName]=
null},_minMaxUpdateDateValue:function(a){var b=a.spanNode,c=a.operator;a=a.editor.get("date");var c="\x3c"===c?"maximum":"minimum",d=this.get(c);a=a&&a.getTime();(d=d!==a)&&(b.innerHTML=this._formatValue(a),this.set(c,a));this._reset();this._updateRoundedLabels();this._generateMoveables();this._generateMinMaxEditors();d&&this.emit("data-value-change",{min:this.minimum,max:this.maximum,values:E.clone(this.values)})},_generateHandleLabelEditor:function(a,b){if(!a._numberEditor){var c,d,e,g,h,q,u;h=
this.get("handles");var k=this.get("maximum"),m=this.get("minimum"),n=this._isZoomed;q=this.get("values");var p=q[b],t=x.indexOf(h,b),w=a.labelNode;("object"==typeof p&&(p=p.value),w.spanNode.innerHTML="",u=r.create("input",{type:"text"},w),h&&0<h.length?(c=null!==h[t-1]?h[t-1]:null,d=null!==h[t+1]?h[t+1]:null,e=q[c],g=q[d],"object"==typeof e&&(e=e.value),"object"==typeof g&&(g=g.value)):(e=q[b-1],g=q[b+1],"object"==typeof e&&(e=e.value),"object"==typeof g&&(g=g.value)),h=void 0!==e&&null!==e?e:n&&
!isNaN(this._minZoomLabel)?this._minZoomLabel:m,q=void 0!==g&&null!==g?g:n&&!isNaN(this._maxZoomLabel)?this._maxZoomLabel:k,this.ratioLabelsVisible&&(p=this._getLabelValueFromIndex(b).replace("%",""),h="undefined"!=typeof e?Number(String(this._getLabelValueFromIndex(c,!0)).replace("%","")):Number(this._minRatioLabel.replace("%",""))||Number(this._getRatioFromValue(this.minimum)),q="undefined"!=typeof g?Number(String(this._getLabelValueFromIndex(d,!0)).replace("%","")):Number(this._maxRatioLabel.replace("%",
""))||Number(this._getRatioFromValue(this.maximum))),this.isDate)?(c=new C({date:new Date(p),required:!0,constraints:{min:new Date(h),max:new Date(q)}},u),b={editor:c,editorPropName:"_numberEditor",min:m,max:k,index:b,zoomed:n,spanNode:w.spanNode,moveable:a},c.on("keydown",f.hitch(this,this._stopKeydownDateHandler,b)),c.on("blur",f.hitch(this,this._stopBlurDateHandler,b)),c.watch("date",f.hitch(this,this._stopUpdateDateValue,b))):(c=new D({value:p,constraints:{min:h,max:q,places:"0,20"}},u),l(c,"keydown",
f.hitch(this,this._keydownHandler,{editor:c,originalValidate:!1})),l(c,"blur",f.hitch(this,this._blurHandler,{editor:c,editorPropName:"_numberEditor",updatedValue:p,min:m,max:k,index:b,zoomed:n,spanNode:w.spanNode,moveable:a})),l(c,"change",f.hitch(this,this._changeHandler,{editor:c,index:b,spanNode:w.spanNode})));a._numberEditor=c;c.focus();c.textbox.select()}},_keydownHandler:function(a,b){var c=a.originalValidate;a=a.editor;if(!1!==c&&(a.validate=c),13===b.keyCode)b=a.get("value"),void 0===b&&
(b=a.get("displayedValue")),b<=a.constraints.max&&b>=a.constraints.min?a.focusNode.blur():(c=a.validate,a.validate(!1),a.validate=function(){return!1})},_blurHandler:function(a,b){b=a.editor;var c=a.editorPropName,d=a.updatedValue,e=a.min,f=a.max,h=a.index,l=a.zoomed,r=a.spanNode;a=a.moveable;isNaN(b.get("value"))&&b.set("value",d);l&&(b.get("value")>f||b.get("value")<e)&&(this._isZoomed=!1,this.emit("zoom-out"));r.innerHTML=this._getLabelValueFromIndex(h);b.destroy();a[c]=null},_changeHandler:function(a,
b){var c=a.editor,d=a.index;a=a.spanNode;var e=b;return b>c.constraints.max||b<c.constraints.min||isNaN(b)||void 0===b?void(a.innerHTML=this._getLabelValueFromIndex(d)):(this.ratioLabelsVisible&&(e=this._getValueFromPercent(b)),"object"==typeof this.values[d]?this.values[d].value=e:this.values[d]=e,this._reset(),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),void this.emit("handle-value-change",{values:this.values}))},_stopKeydownDateHandler:function(a,b){13===
b.keyCode&&a.editor.isValid()&&setTimeout(f.hitch(this,this._destroyHandleEditor,a),0)},_stopBlurDateHandler:function(a,b){setTimeout(f.hitch(this,this._destroyHandleEditor,a),0)},_destroyHandleEditor:function(a){a.spanNode.innerHTML=this._getLabelValueFromIndex(a.index);a.editor.destroy();a.moveable[a.editorPropName]=null},_stopUpdateDateValue:function(a){var b=a.min,c=a.max,d=a.index,e=a.zoomed,f=a.spanNode;a=(a=a.editor.get("date"))&&a.getTime();e&&(a>c||b>a)&&(this._isZoomed=!1,this.emit("zoom-out"));
(b=("object"==typeof this.values[d]?this.values[d].value:this.values[d])!==a)&&("object"==typeof this.values[d]?this.values[d].value=a:this.values[d]=a);f.innerHTML=this._getLabelValueFromIndex(d);this._reset();this._updateRoundedLabels();this._generateMoveables();this._generateMinMaxEditors();b&&this.emit("handle-value-change",{values:this.values})},_getRatioFromValue:function(a){var b=this.get("ratioLabelsVisible");return"percent"===b?100*a:"percentTotal"===b?a/(1+a)*100:null},_getValueFromPercent:function(a){var b=
this.get("ratioLabelsVisible");return"percent"===b?a/100:"percentTotal"===b?100<=a?100:a/(100-a):void 0},_getLabelValueFromIndex:function(a,b){return this.ratioLabelsVisible&&this._ratioLabels[a]?!0===b?parseFloat(this._ratioLabels[a].toFixed(2))+"%":this._formatValue(parseFloat(this._ratioLabels[a].toFixed(2)))+"%":!0===b?this._roundedHandleLabels[a]:this._formatValue(this._roundedHandleLabels[a])},_getValuesFromObject:function(a){var b=[];return x.forEach(a,function(a){b.push(a.value)}),b},_getDecimalPlaces:function(a){return z.format(a,
{places:"0,20",round:-1}).replace(/^-?\d*\.?|0+$/g,"").length},_collisionCheck:function(a,b){return!(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom)},_generateCtrlKeyListener:function(){},_valuesChange:function(){this.emit("data-change",{values:this.get("values")})}})});